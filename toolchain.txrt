2024-09-08 15:22:49.550 | INFO     | __main__:main:1437 - right before barrier for data module
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted
in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 15:22:49.644 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-08 15:23:00.386 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 15:23:00.401 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 15:23:00.416 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 15:23:00.416 | INFO     | __main__:main:1456 - Training dataset size after load: 169441
2024-09-08 15:23:00.416 | INFO     | __main__:main:1457 - Validation dataset size after load: 2482
2024-09-08 15:23:00.416 | INFO     | __main__:main:1458 - Testing dataset size after load: 2685
2024-09-08 15:23:00.416 | INFO     | __main__:main:1460 - Starting progressive training from epoch 0 to 1
2024-09-08 15:23:00.416 | INFO     | __main__:main:1467 - hit the barrier before training
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-09-08 15:23:06,224] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-08 15:23:06,228] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-08 15:23:06,228] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 15:23:10.253 | INFO     | __main__:main:1142 - Running progressive training
2024-09-08 15:23:10.254 | INFO     | __main__:main:1148 - Configuring LeanDojo...
2024-09-08 15:23:10.256 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 15:23:10.257 | INFO     | __main__:main:1150 - LeanDojo configured
2024-09-08 15:23:10.257 | INFO     | __main__:main:1172 - Found 15 repositories
2024-09-08 15:23:10.257 | INFO     | __main__:main:1263 - Starting without curriculum learning
2024-09-08 15:23:10.400 | INFO     | __main__:main:1142 - Running progressive training
2024-09-08 15:23:10.400 | INFO     | __main__:main:1142 - Running progressive training
2024-09-08 15:23:10.400 | INFO     | __main__:main:1148 - Configuring LeanDojo...
2024-09-08 15:23:10.400 | INFO     | __main__:main:1148 - Configuring LeanDojo...
2024-09-08 15:23:10.404 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 15:23:10.404 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 15:23:10.405 | INFO     | __main__:main:1150 - LeanDojo configured
2024-09-08 15:23:10.405 | INFO     | __main__:main:1150 - LeanDojo configured
2024-09-08 15:23:10.405 | INFO     | __main__:main:1172 - Found 15 repositories
2024-09-08 15:23:10.405 | INFO     | __main__:main:1172 - Found 15 repositories
2024-09-08 15:23:10.405 | INFO     | __main__:main:1263 - Starting without curriculum learning
2024-09-08 15:23:10.405 | INFO     | __main__:main:1263 - Starting without curriculum learning
2024-09-08 15:23:10.454 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 15:23:10.587 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 15:23:10.621 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 15:23:25.745 | INFO     | __main__:main:1299 - length of lean_git_repos: 2
2024-09-08 15:23:25.745 | INFO     | __main__:main:1300 - i: 0
2024-09-08 15:23:25.745 | INFO     | __main__:main:1340 - All GPUs
2024-09-08 15:23:25.746 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:23:25.746 | INFO     | __main__:main:1347 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:23:25.746 | INFO     | __main__:main:1353 - Inside train_test_fisher
2024-09-08 15:23:25.746 | INFO     | __main__:main:1354 - Starting training at epoch 0
[rank: 1] Seed set to 3407
2024-09-08 15:23:25.900 | INFO     | __main__:main:1299 - length of lean_git_repos: 2
2024-09-08 15:23:25.901 | INFO     | __main__:main:1300 - i: 0
2024-09-08 15:23:25.901 | INFO     | __main__:main:1340 - All GPUs
2024-09-08 15:23:25.901 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:23:25.901 | INFO     | __main__:main:1347 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:23:25.901 | INFO     | __main__:main:1353 - Inside train_test_fisher
2024-09-08 15:23:25.901 | INFO     | __main__:main:1354 - Starting training at epoch 0
[rank: 2] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly.
It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `
weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.se
rialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly.
It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `
weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.se
rialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-08 15:23:26.321 | INFO     | __main__:main:1299 - length of lean_git_repos: 2
2024-09-08 15:23:26.321 | INFO     | __main__:main:1300 - i: 0
2024-09-08 15:23:26.321 | INFO     | __main__:main:1340 - All GPUs
2024-09-08 15:23:26.322 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:23:26.322 | INFO     | __main__:main:1347 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:23:26.322 | INFO     | __main__:main:1353 - Inside train_test_fisher
2024-09-08 15:23:26.322 | INFO     | __main__:main:1354 - Starting training at epoch 0
[rank: 3] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly.
It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `
weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.se
rialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib
4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib
4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib
4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
2024-09-08 15:23:29.389 | INFO     | __main__:main:1378 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:23:29.506 | INFO     | __main__:main:1437 - right before barrier for data module
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted
in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 15:23:29.606 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-08 15:23:30.244 | INFO     | __main__:main:1378 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:23:30.293 | INFO     | __main__:main:1437 - right before barrier for data module
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-08 15:23:30.313 | INFO     | __main__:main:1378 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:23:30.355 | INFO     | __main__:main:1437 - right before barrier for data module
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted
in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 15:23:30.383 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted
in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 15:23:30.444 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-08 15:23:40.207 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 15:23:40.224 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 15:23:40.239 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 15:23:40.239 | INFO     | __main__:main:1456 - Training dataset size after load: 169441
2024-09-08 15:23:40.239 | INFO     | __main__:main:1457 - Validation dataset size after load: 2482
2024-09-08 15:23:40.239 | INFO     | __main__:main:1458 - Testing dataset size after load: 2685
2024-09-08 15:23:40.240 | INFO     | __main__:main:1460 - Starting progressive training from epoch 0 to 1
2024-09-08 15:23:40.240 | INFO     | __main__:main:1467 - hit the barrier before training
[rank: 1] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
2024-09-08 15:23:40.783 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 15:23:40.796 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 15:23:40.809 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 15:23:40.809 | INFO     | __main__:main:1456 - Training dataset size after load: 169441
2024-09-08 15:23:40.809 | INFO     | __main__:main:1457 - Validation dataset size after load: 2482
2024-09-08 15:23:40.809 | INFO     | __main__:main:1458 - Testing dataset size after load: 2685
2024-09-08 15:23:40.809 | INFO     | __main__:main:1460 - Starting progressive training from epoch 0 to 1
2024-09-08 15:23:40.809 | INFO     | __main__:main:1467 - hit the barrier before training
[rank: 3] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
2024-09-08 15:23:41.142 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 15:23:41.154 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 15:23:41.168 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 15:23:41.168 | INFO     | __main__:main:1456 - Training dataset size after load: 169441
2024-09-08 15:23:41.168 | INFO     | __main__:main:1457 - Validation dataset size after load: 2482
2024-09-08 15:23:41.168 | INFO     | __main__:main:1458 - Testing dataset size after load: 2685
2024-09-08 15:23:41.168 | INFO     | __main__:main:1460 - Starting progressive training from epoch 0 to 1
2024-09-08 15:23:41.168 | INFO     | __main__:main:1467 - hit the barrier before training
[rank: 2] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
2024-09-08 15:23:46.493 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 15:23:46.589 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 15:23:46.605 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_pred/cached_data.pkl
Testing dataset size: 2685
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:653: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr exists and is not empty.
2024-09-08 15:23:46.701 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 15:23:46.795 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 15:23:46.812 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 15:23:48.239 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_train/cached_data.pkl
2024-09-08 15:23:48.292 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 15:23:48.363 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 15:23:48.387 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_pred/cached_data.pkl
Training dataset size: 169441
Testing dataset size: 2685
2024-09-08 15:23:48.414 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 15:23:48.437 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_pred/cached_data.pkl
Testing dataset size: 2685
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly.
It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `
weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.se
rialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib
4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib
4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib
4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib
4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-08 15:23:49.505 | INFO     | common:get_optimizers:445 - Optimizing with AdamW
2024-09-08 15:23:49.514 | INFO     | common:get_optimizers:445 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
2024-09-08 15:23:49.517 | INFO     | common:get_optimizers:445 - Optimizing with AdamW
2024-09-08 15:23:49.517 | INFO     | common:get_optimizers:445 - Optimizing with AdamW
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
Epoch 0:   0%|                                                                                                                                                                                                                | 0/2 [00:00<?, ?it/s]
An error occurred during training: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 79.32 GiB of which 2.88 MiB is free. Process 572274 has 16.25 GiB memory in use. Process 577356 has 414.00 MiB memory in use. Proc
ess 577357 has 414.00 MiB memory in use. Process 577358 has 414.00 MiB memory in use. Process 903501 has 4.99 GiB memory in use. Process 903630 has 3.93 GiB memory in use. Process 903629 has 3.93 GiB memory in use. Process 903628 has 3.93 GiB m
emory in use. Process 904401 has 7.15 GiB memory in use. Process 904496 has 3.93 GiB memory in use. Process 904497 has 3.93 GiB memory in use. Process 904498 has 3.93 GiB memory in use. Process 916107 has 14.56 GiB memory in use. Process 916236
 has 414.00 MiB memory in use. Process 916235 has 414.00 MiB memory in use. Process 916234 has 414.00 MiB memory in use. Including non-PyTorch memory, this process has 9.08 GiB memory in use. Process 919092 has 414.00 MiB memory in use. Process
 919093 has 414.00 MiB memory in use. Process 919094 has 414.00 MiB memory in use. Of the allocated memory 7.49 GiB is allocated by PyTorch, and 105.07 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try
setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1469, in main
    trainer.fit(model, datamodule=data_module, ckpt_path=model_checkpoint_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
    results = self._run_stage()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1033, in _run_stage
    self.fit_loop.run()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 205, in run
    self.advance()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 363, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 140, in run
    self.advance(data_fetcher)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 250, in advance
    batch_output = self.automatic_optimization.run(trainer.optimizers[0], batch_idx, kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 183, in run
    closure()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 144, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 129, in closure
    step_output = self._step_fn()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 318, in _training_step
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in training_step
    return self._forward_redirection(self.model, self.lightning_module, "training_step", *args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 642, in __call__
    wrapper_output = wrapper_module(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1636, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1454, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 635, in wrapped_forward
    out = method(*_args, **_kwargs)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/model.py", line 242, in training_step
    loss = self(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/model.py", line 213, in forward
    pos_premise_emb = self._encode(pos_premise_ids, pos_premise_mask)
  File "/data/yingzi_ma/lean_project/ReProver/retrieval/model.py", line 184, in _encode
    hidden_states = self.encoder(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/models/t5/modeling_t5.py", line 1971, in forward
    encoder_outputs = self.encoder(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/models/t5/modeling_t5.py", line 1106, in forward
    layer_outputs = layer_module(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/models/t5/modeling_t5.py", line 746, in forward
    hidden_states = self.layer[-1](hidden_states)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/models/t5/modeling_t5.py", line 335, in forward
    forwarded_states = self.DenseReluDense(forwarded_states)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/models/t5/modeling_t5.py", line 303, in forward
    hidden_gelu = self.act(self.wi_0(hidden_states))
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/activations.py", line 56, in forward
    return 0.5 * input * (1.0 + torch.tanh(math.sqrt(2.0 / math.pi) * (input + 0.044715 * torch.pow(input, 3.0))))
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 79.32 GiB of which 2.88 MiB is free. Process 572274 has 16.25 GiB memory in use. Process 577356 has 414.00 MiB memory in use. Process 577357
has 414.00 MiB memory in use. Process 577358 has 414.00 MiB memory in use. Process 903501 has 4.99 GiB memory in use. Process 903630 has 3.93 GiB memory in use. Process 903629 has 3.93 GiB memory in use. Process 903628 has 3.93 GiB memory in us
e. Process 904401 has 7.15 GiB memory in use. Process 904496 has 3.93 GiB memory in use. Process 904497 has 3.93 GiB memory in use. Process 904498 has 3.93 GiB memory in use. Process 916107 has 14.56 GiB memory in use. Process 916236 has 414.00
 MiB memory in use. Process 916235 has 414.00 MiB memory in use. Process 916234 has 414.00 MiB memory in use. Including non-PyTorch memory, this process has 9.08 GiB memory in use. Process 919092 has 414.00 MiB memory in use. Process 919093 has
 414.00 MiB memory in use. Process 919094 has 414.00 MiB memory in use. Of the allocated memory 7.49 GiB is allocated by PyTorch, and 105.07 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYT
ORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-09-08 15:23:51.399 | INFO     | __main__:main:1476 - Finished progressive training at epoch 0
2024-09-08 15:23:51.400 | WARNING  | __main__:main:1486 - No best model found. Using the last trained model.
2024-09-08 15:23:51.401 | INFO     | __main__:main:1495 - Testing...
2024-09-08 15:23:51.402 | INFO     | retrieval.main:run_cli:60 - PID: 918976
[rank: 0] Seed set to 3407
2024-09-08 15:23:51.593 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-08 15:23:51.593 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted
in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 15:23:52.095 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
2024-09-08 15:24:02.562 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 15:24:02.577 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_pred/cached_data.pkl
Testing dataset size: 2685
^C^Z
[28]+  Stopped                 bash run_code.sh
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ nvidia-smi
Sun Sep  8 15:24:38 2024
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:0F:00.0 Off |                    0 |
| N/A   42C    P0             93W /  400W |   81119MiB /  81920MiB |    100%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:15:00.0 Off |                    0 |
| N/A   38C    P0             96W /  400W |   69209MiB /  81920MiB |    100%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:53:00.0 Off |                    0 |
| N/A   50C    P0             97W /  400W |   61419MiB /  81920MiB |    100%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:D6:00.0 Off |                    0 |
| N/A   37C    P0             89W /  400W |   67051MiB /  81920MiB |    100%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A    903501      C   python                                       5108MiB |
|    0   N/A  N/A    903628      C   ...miniconda3/envs/ReProver/bin/python       4024MiB |
|    0   N/A  N/A    903629      C   ...miniconda3/envs/ReProver/bin/python       4024MiB |
|    0   N/A  N/A    903630      C   ...miniconda3/envs/ReProver/bin/python       4024MiB |
|    0   N/A  N/A    904401      C   python                                       7320MiB |
|    0   N/A  N/A    904496      C   ...miniconda3/envs/ReProver/bin/python       4024MiB |
|    0   N/A  N/A    904497      C   ...miniconda3/envs/ReProver/bin/python       4024MiB |
|    0   N/A  N/A    904498      C   ...miniconda3/envs/ReProver/bin/python       4024MiB |
|    0   N/A  N/A    916107      C   python                                      14910MiB |
|    0   N/A  N/A    916234      C   ...miniconda3/envs/ReProver/bin/python        414MiB |
|    0   N/A  N/A    916235      C   ...miniconda3/envs/ReProver/bin/python        414MiB |
|    0   N/A  N/A    916236      C   ...miniconda3/envs/ReProver/bin/python        414MiB |
|    0   N/A  N/A    918976      C   python                                       9194MiB |
|    0   N/A  N/A    919092      C   ...miniconda3/envs/ReProver/bin/python        414MiB |
|    0   N/A  N/A    919093      C   ...miniconda3/envs/ReProver/bin/python        414MiB |
|    0   N/A  N/A    919094      C   ...miniconda3/envs/ReProver/bin/python        414MiB |
|    1   N/A  N/A    903628      C   ...miniconda3/envs/ReProver/bin/python       2556MiB |
|    1   N/A  N/A    904496      C   ...miniconda3/envs/ReProver/bin/python       3858MiB |
|    1   N/A  N/A    916234      C   ...miniconda3/envs/ReProver/bin/python      27782MiB |
|    1   N/A  N/A    919092      C   ...miniconda3/envs/ReProver/bin/python      18208MiB |
|    2   N/A  N/A    903629      C   ...miniconda3/envs/ReProver/bin/python       2556MiB |
|    2   N/A  N/A    904497      C   ...miniconda3/envs/ReProver/bin/python       3856MiB |
|    2   N/A  N/A    916235      C   ...miniconda3/envs/ReProver/bin/python      23906MiB |
|    2   N/A  N/A    919093      C   ...miniconda3/envs/ReProver/bin/python      14296MiB |
|    3   N/A  N/A    903630      C   ...miniconda3/envs/ReProver/bin/python       2412MiB |
|    3   N/A  N/A    904498      C   ...miniconda3/envs/ReProver/bin/python       3712MiB |
|    3   N/A  N/A    916236      C   ...miniconda3/envs/ReProver/bin/python      30348MiB |
|    3   N/A  N/A    919094      C   ...miniconda3/envs/ReProver/bin/python      13918MiB |
+-----------------------------------------------------------------------------------------+
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ ray stop
Could not terminate `/usr/bin/python3 /usr/local/bin/user_traffic_monitor.py` due to (pid=283579, name='python3')
Traceback (most recent call last):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/thirdparty_files/psutil/__init__.py", line 1245, in _send_signal
    os.kill(self.pid, sig)
ProcessLookupError: [Errno 3] No such process

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/yingzi_ma/miniconda3/envs/ReProver/bin/ray", line 8, in <module>
    sys.exit(main())
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/scripts/scripts.py", line 2615, in main
    return cli()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/autoscaler/_private/cli_logger.py", line 856, in wrapper
    return f(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/scripts/scripts.py", line 1179, in stop
    found, stopped, alive = kill_procs(force, grace_period / len(buckets), bucket)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/scripts/scripts.py", line 1154, in kill_procs
    proc.kill()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/thirdparty_files/psutil/__init__.py", line 1310, in kill
    self._send_signal(signal.SIGKILL)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/thirdparty_files/psutil/__init__.py", line 1253, in _send_signal
    raise NoSuchProcess(self.pid, self._name)
psutil.NoSuchProcess: process no longer exists (pid=906328, name='python')
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ python ppl_gpus.py
GPU UUID                                     PID  User       Process Name      GPU Memory Usage (MB)    GPU Index  GPU Name
----------------------------------------  ------  ---------  --------------  -----------------------  -----------  ---------------------
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  572274  yingzi_ma  pt_main_thread                    16638            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  903501  yingzi_ma  pt_main_thread                     5108            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  903630  yingzi_ma  pt_main_thread                     4024            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  903629  yingzi_ma  pt_main_thread                     4024            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  903628  yingzi_ma  pt_main_thread                     4024            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  904401  yingzi_ma  pt_main_thread                     7320            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  904496  yingzi_ma  pt_main_thread                     4024            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  904497  yingzi_ma  pt_main_thread                     4024            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  904498  yingzi_ma  pt_main_thread                     4024            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  916107  yingzi_ma  pt_main_thread                    14910            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  916236  yingzi_ma  pt_main_thread                      414            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  916235  yingzi_ma  pt_main_thread                      414            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  916234  yingzi_ma  pt_main_thread                      414            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  918976  yingzi_ma  pt_main_thread                     9194            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  919092  yingzi_ma  pt_main_thread                      414            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  919093  yingzi_ma  pt_main_thread                      414            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  919094  yingzi_ma  pt_main_thread                      414            0  NVIDIA A100-SXM4-80GB
GPU-32e0e849-07a3-675d-607a-e4a4aa0e94c3  903628  yingzi_ma  pt_main_thread                     2556            1  NVIDIA A100-SXM4-80GB
GPU-32e0e849-07a3-675d-607a-e4a4aa0e94c3  904496  yingzi_ma  pt_main_thread                     3858            1  NVIDIA A100-SXM4-80GB
GPU-32e0e849-07a3-675d-607a-e4a4aa0e94c3  916234  yingzi_ma  pt_main_thread                    27782            1  NVIDIA A100-SXM4-80GB
GPU-32e0e849-07a3-675d-607a-e4a4aa0e94c3  919092  yingzi_ma  pt_main_thread                    18208            1  NVIDIA A100-SXM4-80GB
GPU-138080ee-7067-8d64-5f32-888dcb1369a1  903629  yingzi_ma  pt_main_thread                     2556            2  NVIDIA A100-SXM4-80GB
GPU-138080ee-7067-8d64-5f32-888dcb1369a1  904497  yingzi_ma  pt_main_thread                     3856            2  NVIDIA A100-SXM4-80GB
GPU-138080ee-7067-8d64-5f32-888dcb1369a1  916235  yingzi_ma  pt_main_thread                    23906            2  NVIDIA A100-SXM4-80GB
GPU-138080ee-7067-8d64-5f32-888dcb1369a1  919093  yingzi_ma  pt_main_thread                    14296            2  NVIDIA A100-SXM4-80GB
GPU-6831d1f1-6c9c-de6b-b4d1-768186dbc285  903630  yingzi_ma  pt_main_thread                     2412            3  NVIDIA A100-SXM4-80GB
GPU-6831d1f1-6c9c-de6b-b4d1-768186dbc285  904498  yingzi_ma  pt_main_thread                     3712            3  NVIDIA A100-SXM4-80GB
GPU-6831d1f1-6c9c-de6b-b4d1-768186dbc285  916236  yingzi_ma  pt_main_thread                    30348            3  NVIDIA A100-SXM4-80GB
GPU-6831d1f1-6c9c-de6b-b4d1-768186dbc285  919094  yingzi_ma  pt_main_thread                    13918            3  NVIDIA A100-SXM4-80GB
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ kill -9 903501 572274 903630 903629 903628 904401 904496
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ python ppl_gpus.py
GPU UUID                                     PID  User       Process Name      GPU Memory Usage (MB)    GPU Index  GPU Name
----------------------------------------  ------  ---------  --------------  -----------------------  -----------  ---------------------
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  572274  yingzi_ma  pt_main_thread                    16638            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  904496  yingzi_ma  pt_main_thread                     4312            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  904497  yingzi_ma  pt_main_thread                     4024            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  904498  yingzi_ma  pt_main_thread                     4168            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  916107  yingzi_ma  pt_main_thread                    14910            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  916236  yingzi_ma  pt_main_thread                      414            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  916235  yingzi_ma  pt_main_thread                      414            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  916234  yingzi_ma  pt_main_thread                      414            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  918976  yingzi_ma  pt_main_thread                     9194            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  919092  yingzi_ma  pt_main_thread                      414            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  919093  yingzi_ma  pt_main_thread                      414            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  919094  yingzi_ma  pt_main_thread                      414            0  NVIDIA A100-SXM4-80GB
GPU-32e0e849-07a3-675d-607a-e4a4aa0e94c3  904496  yingzi_ma  pt_main_thread                     3858            1  NVIDIA A100-SXM4-80GB
GPU-32e0e849-07a3-675d-607a-e4a4aa0e94c3  916234  yingzi_ma  pt_main_thread                    27782            1  NVIDIA A100-SXM4-80GB
GPU-32e0e849-07a3-675d-607a-e4a4aa0e94c3  919092  yingzi_ma  pt_main_thread                    18208            1  NVIDIA A100-SXM4-80GB
GPU-138080ee-7067-8d64-5f32-888dcb1369a1  904497  yingzi_ma  pt_main_thread                     3856            2  NVIDIA A100-SXM4-80GB
GPU-138080ee-7067-8d64-5f32-888dcb1369a1  916235  yingzi_ma  pt_main_thread                    23906            2  NVIDIA A100-SXM4-80GB
GPU-138080ee-7067-8d64-5f32-888dcb1369a1  919093  yingzi_ma  pt_main_thread                    14296            2  NVIDIA A100-SXM4-80GB
GPU-6831d1f1-6c9c-de6b-b4d1-768186dbc285  904498  yingzi_ma  pt_main_thread                     3712            3  NVIDIA A100-SXM4-80GB
GPU-6831d1f1-6c9c-de6b-b4d1-768186dbc285  916236  yingzi_ma  pt_main_thread                    30348            3  NVIDIA A100-SXM4-80GB
GPU-6831d1f1-6c9c-de6b-b4d1-768186dbc285  919094  yingzi_ma  pt_main_thread                    13918            3  NVIDIA A100-SXM4-80GB
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ kill -9 572274 904496 904497 916107 904498
bash: kill: (904496) - No such process
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ python ppl_gpus.py
GPU UUID                                     PID  User       Process Name      GPU Memory Usage (MB)    GPU Index  GPU Name
----------------------------------------  ------  ---------  --------------  -----------------------  -----------  ---------------------
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  572274  yingzi_ma  pt_main_thread                    16638            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  916107  yingzi_ma  pt_main_thread                    14910            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  916236  yingzi_ma  pt_main_thread                      414            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  916235  yingzi_ma  pt_main_thread                      414            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  916234  yingzi_ma  pt_main_thread                      414            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  918976  yingzi_ma  pt_main_thread                     9194            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  919092  yingzi_ma  pt_main_thread                      414            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  919093  yingzi_ma  pt_main_thread                      414            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  919094  yingzi_ma  pt_main_thread                      414            0  NVIDIA A100-SXM4-80GB
GPU-32e0e849-07a3-675d-607a-e4a4aa0e94c3  916234  yingzi_ma  pt_main_thread                    27782            1  NVIDIA A100-SXM4-80GB
GPU-32e0e849-07a3-675d-607a-e4a4aa0e94c3  919092  yingzi_ma  pt_main_thread                    18208            1  NVIDIA A100-SXM4-80GB
GPU-138080ee-7067-8d64-5f32-888dcb1369a1  916235  yingzi_ma  pt_main_thread                    23906            2  NVIDIA A100-SXM4-80GB
GPU-138080ee-7067-8d64-5f32-888dcb1369a1  919093  yingzi_ma  pt_main_thread                    14296            2  NVIDIA A100-SXM4-80GB
GPU-6831d1f1-6c9c-de6b-b4d1-768186dbc285  916236  yingzi_ma  pt_main_thread                    30348            3  NVIDIA A100-SXM4-80GB
GPU-6831d1f1-6c9c-de6b-b4d1-768186dbc285  919094  yingzi_ma  pt_main_thread                    13918            3  NVIDIA A100-SXM4-80GB
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ kill -9 572274  916107 916236 916235 916234 918976  919092 919093
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ python ppl_gpus.py
GPU UUID                                     PID  User       Process Name      GPU Memory Usage (MB)    GPU Index  GPU Name
----------------------------------------  ------  ---------  --------------  -----------------------  -----------  ---------------------
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  572274  yingzi_ma  pt_main_thread                    16638            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  916107  yingzi_ma  pt_main_thread                    14910            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  919094  yingzi_ma  pt_main_thread                      558            0  NVIDIA A100-SXM4-80GB
GPU-6831d1f1-6c9c-de6b-b4d1-768186dbc285  919094  yingzi_ma  pt_main_thread                    13918            3  NVIDIA A100-SXM4-80GB
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ kill -9 572274 916107 919094
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ python ppl_gpus.py
GPU UUID                                     PID  User       Process Name      GPU Memory Usage (MB)    GPU Index  GPU Name
----------------------------------------  ------  ---------  --------------  -----------------------  -----------  ---------------------
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  572274  yingzi_ma  pt_main_thread                    16638            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  916107  yingzi_ma  pt_main_thread                    14910            0  NVIDIA A100-SXM4-80GB
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ nvidia-smi
Sun Sep  8 15:26:29 2024
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:0F:00.0 Off |                    0 |
| N/A   41C    P0             88W /  400W |   34069MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:15:00.0 Off |                    0 |
| N/A   38C    P0             91W /  400W |   44577MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:53:00.0 Off |                    0 |
| N/A   49C    P0             91W /  400W |   40701MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:D6:00.0 Off |                    0 |
| N/A   37C    P0             84W /  400W |   46999MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
+-----------------------------------------------------------------------------------------+
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ ray stop
Could not terminate `/usr/bin/python3 /usr/local/bin/user_traffic_monitor.py` due to (pid=283579, name='python3')
Stopped only 0 out of 14 Ray processes within the grace period 16 seconds. Set `-v` to see more details. Remaining processes [psutil.Process(pid=906798, name='python', status='terminated', started='15:05:24'), psutil.Process(pid=906390, name='p
ython', status='terminated', started='15:05:21'), psutil.Process(pid=906805, name='python', status='terminated', started='15:05:24'), psutil.Process(pid=906204, name='ray::IDLE', status='terminated', started='15:05:16'), psutil.Process(pid=9061
88, name='ray::IDLE', status='terminated', started='15:05:16'), psutil.Process(pid=906351, name='python', status='terminated', started='15:05:19'), psutil.Process(pid=906201, name='ray::IDLE', status='terminated', started='15:05:16'), psutil.Pr
ocess(pid=906322, name='python', status='terminated', started='15:05:18'), psutil.Process(pid=906468, name='python', status='terminated', started='15:05:22'), psutil.Process(pid=906801, name='python', status='terminated', started='15:05:24'), p
sutil.Process(pid=906812, name='python', status='terminated', started='15:05:24'), psutil.Process(pid=906808, name='python', status='terminated', started='15:05:24'), psutil.Process(pid=906792, name='python', status='terminated', started='15:05
:24'), psutil.Process(pid=906662, name='python', status='terminated', started='15:05:24')] will be forcefully terminated.
You can also use `--force` to forcefully terminate processes or set higher `--grace-period` to wait longer time for proper termination.
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ ray stop --force
Could not terminate `/usr/bin/python3 /usr/local/bin/user_traffic_monitor.py` due to (pid=283579, name='python3')
Did not find any active Ray processes.
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ nvidia-smi
Sun Sep  8 15:26:55 2024
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:0F:00.0 Off |                    0 |
| N/A   41C    P0             88W /  400W |   34069MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:15:00.0 Off |                    0 |
| N/A   38C    P0             91W /  400W |   44577MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:53:00.0 Off |                    0 |
| N/A   49C    P0             91W /  400W |   40701MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:D6:00.0 Off |                    0 |
| N/A   36C    P0             84W /  400W |   46999MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
+-----------------------------------------------------------------------------------------+
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ python ppl_gpus.py
GPU UUID                                     PID  User       Process Name      GPU Memory Usage (MB)    GPU Index  GPU Name
----------------------------------------  ------  ---------  --------------  -----------------------  -----------  ---------------------
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  572274  yingzi_ma  pt_main_thread                    16638            0  NVIDIA A100-SXM4-80GB
GPU-50e0b950-9b98-73ac-0c65-7c1290f87170  916107  yingzi_ma  pt_main_thread                    14910            0  NVIDIA A100-SXM4-80GB
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 15:27:16,382] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 15:27:20.104 | INFO     | __main__:main:1142 - Running progressive training
2024-09-08 15:27:20.104 | INFO     | __main__:main:1148 - Configuring LeanDojo...
2024-09-08 15:27:20.107 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 15:27:20.107 | INFO     | __main__:main:1150 - LeanDojo configured
2024-09-08 15:27:20.107 | INFO     | __main__:main:1155 - Starting the main process
2024-09-08 15:27:20.107 | INFO     | __main__:main:1163 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 15:27:28.479 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 15:27:28.479 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 15:27:28.583 | INFO     | __main__:main:1165 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_retrieval_single_repo_no_ewc_pfr.json
2024-09-08 15:27:28.583 | INFO     | __main__:main:1172 - Found 15 repositories
2024-09-08 15:27:28.583 | INFO     | __main__:main:1263 - Starting without curriculum learning
2024-09-08 15:27:28.813 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 15:27:44.125 | INFO     | __main__:main:1299 - length of lean_git_repos: 2
2024-09-08 15:27:44.125 | INFO     | __main__:main:1300 - i: 0
2024-09-08 15:27:44.125 | INFO     | __main__:main:1305 - Main process
2024-09-08 15:27:44.126 | INFO     | __main__:main:1306 - Using lambda = 0.1
2024-09-08 15:27:44.126 | INFO     | __main__:main:1307 - Processing https://github.com/teorth/pfr
2024-09-08 15:27:44.126 | INFO     | __main__:main:1329 - Adding repo to repos_for_merged_dataset
2024-09-08 15:27:44.126 | INFO     | __main__:main:1340 - All GPUs
2024-09-08 15:27:44.126 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:27:44.126 | INFO     | __main__:main:1347 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:27:44.126 | INFO     | __main__:main:1353 - Inside train_test_fisher
2024-09-08 15:27:44.126 | INFO     | __main__:main:1354 - Starting training at epoch 0
[rank: 0] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly.
It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `
weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.se
rialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib
4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
2024-09-08 15:27:46.383 | INFO     | __main__:main:1378 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python main.py ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer(limit_val_batches=1)` was configured so 1 batch will be used.
2024-09-08 15:27:46.479 | INFO     | __main__:main:1437 - right before barrier for data module
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted
in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 15:27:46.586 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-08 15:27:56.806 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 15:27:56.821 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 15:27:56.835 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 15:27:56.836 | INFO     | __main__:main:1456 - Training dataset size after load: 169441
2024-09-08 15:27:56.836 | INFO     | __main__:main:1457 - Validation dataset size after load: 2482
2024-09-08 15:27:56.836 | INFO     | __main__:main:1458 - Testing dataset size after load: 2685
2024-09-08 15:27:56.836 | INFO     | __main__:main:1460 - Starting progressive training from epoch 0 to 1
2024-09-08 15:27:56.836 | INFO     | __main__:main:1467 - hit the barrier before training
[rank: 0] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
[2024-09-08 15:28:02,608] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-08 15:28:02,610] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-08 15:28:02,610] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 15:28:06.686 | INFO     | __main__:main:1142 - Running progressive training
2024-09-08 15:28:06.686 | INFO     | __main__:main:1148 - Configuring LeanDojo...
2024-09-08 15:28:06.689 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 15:28:06.689 | INFO     | __main__:main:1150 - LeanDojo configured
2024-09-08 15:28:06.689 | INFO     | __main__:main:1172 - Found 15 repositories
2024-09-08 15:28:06.689 | INFO     | __main__:main:1263 - Starting without curriculum learning
2024-09-08 15:28:06.828 | INFO     | __main__:main:1142 - Running progressive training
2024-09-08 15:28:06.828 | INFO     | __main__:main:1142 - Running progressive training
2024-09-08 15:28:06.828 | INFO     | __main__:main:1148 - Configuring LeanDojo...
2024-09-08 15:28:06.828 | INFO     | __main__:main:1148 - Configuring LeanDojo...
2024-09-08 15:28:06.833 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 15:28:06.833 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 15:28:06.833 | INFO     | __main__:main:1150 - LeanDojo configured
2024-09-08 15:28:06.833 | INFO     | __main__:main:1150 - LeanDojo configured
2024-09-08 15:28:06.833 | INFO     | __main__:main:1172 - Found 15 repositories
2024-09-08 15:28:06.833 | INFO     | __main__:main:1172 - Found 15 repositories
2024-09-08 15:28:06.833 | INFO     | __main__:main:1263 - Starting without curriculum learning
2024-09-08 15:28:06.833 | INFO     | __main__:main:1263 - Starting without curriculum learning
2024-09-08 15:28:07.036 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 15:28:07.036 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 15:28:07.037 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc1
2024-09-08 15:28:22.190 | INFO     | __main__:main:1299 - length of lean_git_repos: 2
2024-09-08 15:28:22.190 | INFO     | __main__:main:1300 - i: 0
2024-09-08 15:28:22.190 | INFO     | __main__:main:1340 - All GPUs
2024-09-08 15:28:22.191 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:28:22.191 | INFO     | __main__:main:1347 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:28:22.191 | INFO     | __main__:main:1353 - Inside train_test_fisher
2024-09-08 15:28:22.191 | INFO     | __main__:main:1354 - Starting training at epoch 0
[rank: 1] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly.
It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `
weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.se
rialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
2024-09-08 15:28:22.418 | INFO     | __main__:main:1299 - length of lean_git_repos: 2
2024-09-08 15:28:22.419 | INFO     | __main__:main:1300 - i: 0
2024-09-08 15:28:22.419 | INFO     | __main__:main:1340 - All GPUs
2024-09-08 15:28:22.419 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:28:22.419 | INFO     | __main__:main:1347 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:28:22.419 | INFO     | __main__:main:1353 - Inside train_test_fisher
2024-09-08 15:28:22.419 | INFO     | __main__:main:1354 - Starting training at epoch 0
[rank: 2] Seed set to 3407
2024-09-08 15:28:22.451 | INFO     | __main__:main:1299 - length of lean_git_repos: 2
2024-09-08 15:28:22.451 | INFO     | __main__:main:1300 - i: 0
2024-09-08 15:28:22.451 | INFO     | __main__:main:1340 - All GPUs
2024-09-08 15:28:22.451 | INFO     | __main__:find_latest_checkpoint:483 - Using the latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:28:22.451 | INFO     | __main__:main:1347 - Found latest checkpoint: /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:28:22.452 | INFO     | __main__:main:1353 - Inside train_test_fisher
2024-09-08 15:28:22.452 | INFO     | __main__:main:1354 - Starting training at epoch 0
[rank: 3] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly.
It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `
weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.se
rialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly.
It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `
weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.se
rialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib
4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib
4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib
4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
2024-09-08 15:28:25.918 | INFO     | __main__:main:1378 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:28:26.032 | INFO     | __main__:main:1437 - right before barrier for data module
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted
in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 15:28:26.139 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-08 15:28:26.278 | INFO     | __main__:main:1378 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:28:26.338 | INFO     | __main__:main:1437 - right before barrier for data module
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted
in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 15:28:26.432 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-08 15:28:26.672 | INFO     | __main__:main:1378 - Loaded premise retriever at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:28:26.717 | INFO     | __main__:main:1437 - right before barrier for data module
Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted
in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 15:28:26.811 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-08 15:28:36.457 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 15:28:36.471 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 15:28:36.485 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 15:28:36.485 | INFO     | __main__:main:1456 - Training dataset size after load: 169441
2024-09-08 15:28:36.485 | INFO     | __main__:main:1457 - Validation dataset size after load: 2482
2024-09-08 15:28:36.485 | INFO     | __main__:main:1458 - Testing dataset size after load: 2685
2024-09-08 15:28:36.485 | INFO     | __main__:main:1460 - Starting progressive training from epoch 0 to 1
2024-09-08 15:28:36.485 | INFO     | __main__:main:1467 - hit the barrier before training
2024-09-08 15:28:36.569 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 15:28:36.582 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 15:28:36.600 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 15:28:36.600 | INFO     | __main__:main:1456 - Training dataset size after load: 169441
2024-09-08 15:28:36.600 | INFO     | __main__:main:1457 - Validation dataset size after load: 2482
2024-09-08 15:28:36.600 | INFO     | __main__:main:1458 - Testing dataset size after load: 2685
2024-09-08 15:28:36.600 | INFO     | __main__:main:1460 - Starting progressive training from epoch 0 to 1
2024-09-08 15:28:36.600 | INFO     | __main__:main:1467 - hit the barrier before training
[rank: 2] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
[rank: 3] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
2024-09-08 15:28:37.364 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 15:28:37.377 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 15:28:37.390 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 15:28:37.390 | INFO     | __main__:main:1456 - Training dataset size after load: 169441
2024-09-08 15:28:37.390 | INFO     | __main__:main:1457 - Validation dataset size after load: 2482
2024-09-08 15:28:37.390 | INFO     | __main__:main:1458 - Testing dataset size after load: 2685
2024-09-08 15:28:37.391 | INFO     | __main__:main:1460 - Starting progressive training from epoch 0 to 1
2024-09-08 15:28:37.391 | INFO     | __main__:main:1467 - hit the barrier before training
[rank: 1] Seed set to 3407
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

NCCL version 2.20.5+cuda12.4
2024-09-08 15:28:41.767 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 15:28:41.856 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 15:28:41.875 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_pred/cached_data.pkl
Testing dataset size: 2685
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:653: Checkpoint directory /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr exists and is not empty.
2024-09-08 15:28:42.001 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 15:28:42.092 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 15:28:42.108 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 15:28:42.203 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_train/cached_data.pkl
2024-09-08 15:28:42.258 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 15:28:42.299 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 15:28:42.316 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_pred/cached_data.pkl
Testing dataset size: 2685
Training dataset size: 169441
2024-09-08 15:28:42.350 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_val/cached_data.pkl
Validation dataset size: 2482
2024-09-08 15:28:42.366 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_pred/cached_data.pkl
Testing dataset size: 2685
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly.
It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `
weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.se
rialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib
4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib
4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib
4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib
4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt`
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-08 15:28:43.262 | INFO     | common:get_optimizers:445 - Optimizing with AdamW
2024-09-08 15:28:43.263 | INFO     | common:get_optimizers:445 - Optimizing with AdamW
2024-09-08 15:28:43.263 | INFO     | common:get_optimizers:445 - Optimizing with AdamW
2024-09-08 15:28:43.263 | INFO     | common:get_optimizers:445 - Optimizing with AdamW

  | Name    | Type           | Params
-------------------------------------------
0 | encoder | T5EncoderModel | 217 M
-------------------------------------------
217 M     Trainable params
0         Non-trainable params
217 M     Total params
870.630   Total estimated model params size (MB)
Restored all states from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
Epoch 0: 100%|| 2/2 [00:01<00:00,  1.31it/s, v_num=17106]
2024-09-08 15:28:45.795 | INFO     | retrieval.model:validation_step:325 - Inside validation_step
                                                                                                                                                                                                                                                   2
024-09-08 15:28:45.820 | INFO     | retrieval.model:validation_step:325 - Inside validation_step                                                                                                                              | 0/? [00:00<?, ?it/s]
2024-09-08 15:28:45.849 | INFO     | retrieval.model:validation_step:329 - Embeddings staled validation step: False
2024-09-08 15:28:45.881 | INFO     | retrieval.model:validation_step:329 - Embeddings staled validation step: False
                                                                                                                                                                                                                                                   2
024-09-08 15:28:45.978 | INFO     | retrieval.model:validation_step:325 - Inside validation_step                                                                                                                              | 0/1 [00:00<?, ?it/s]
2024-09-08 15:28:45.988 | INFO     | retrieval.model:validation_step:325 - Inside validation_step
2024-09-08 15:28:46.013 | INFO     | retrieval.model:validation_step:329 - Embeddings staled validation step: False
2024-09-08 15:28:46.016 | INFO     | retrieval.model:validation_step:329 - Embeddings staled validation step: False
2024-09-08 15:28:48.274 | INFO     | retrieval.model:validation_step:379 - Recall@1_val: 0.0
2024-09-08 15:28:48.277 | INFO     | retrieval.model:validation_step:379 - Recall@2_val: 0.0
2024-09-08 15:28:48.278 | INFO     | retrieval.model:validation_step:379 - Recall@3_val: 0.0
2024-09-08 15:28:48.279 | INFO     | retrieval.model:validation_step:379 - Recall@4_val: 0.0
2024-09-08 15:28:48.279 | INFO     | retrieval.model:validation_step:379 - Recall@5_val: 0.0
2024-09-08 15:28:48.280 | INFO     | retrieval.model:validation_step:379 - Recall@6_val: 0.0
2024-09-08 15:28:48.281 | INFO     | retrieval.model:validation_step:379 - Recall@7_val: 0.0
2024-09-08 15:28:48.282 | INFO     | retrieval.model:validation_step:379 - Recall@8_val: 0.0
2024-09-08 15:28:48.283 | INFO     | retrieval.model:validation_step:379 - Recall@9_val: 0.0
2024-09-08 15:28:48.284 | INFO     | retrieval.model:validation_step:379 - Recall@10_val: 0.0
2024-09-08 15:28:48.285 | INFO     | retrieval.model:validation_step:379 - Recall@11_val: 0.0
2024-09-08 15:28:48.285 | INFO     | retrieval.model:validation_step:379 - Recall@12_val: 0.0
2024-09-08 15:28:48.286 | INFO     | retrieval.model:validation_step:379 - Recall@13_val: 0.0
2024-09-08 15:28:48.287 | INFO     | retrieval.model:validation_step:379 - Recall@14_val: 0.0
2024-09-08 15:28:48.288 | INFO     | retrieval.model:validation_step:379 - Recall@15_val: 0.0
2024-09-08 15:28:48.289 | INFO     | retrieval.model:validation_step:379 - Recall@16_val: 0.0
2024-09-08 15:28:48.290 | INFO     | retrieval.model:validation_step:379 - Recall@17_val: 0.0
2024-09-08 15:28:48.290 | INFO     | retrieval.model:validation_step:379 - Recall@18_val: 0.0
2024-09-08 15:28:48.291 | INFO     | retrieval.model:validation_step:379 - Recall@19_val: 0.0
2024-09-08 15:28:48.292 | INFO     | retrieval.model:validation_step:379 - Recall@20_val: 0.0
2024-09-08 15:28:48.293 | INFO     | retrieval.model:validation_step:379 - Recall@21_val: 0.0
2024-09-08 15:28:48.294 | INFO     | retrieval.model:validation_step:379 - Recall@22_val: 0.0
2024-09-08 15:28:48.295 | INFO     | retrieval.model:validation_step:379 - Recall@23_val: 0.0
2024-09-08 15:28:48.296 | INFO     | retrieval.model:validation_step:379 - Recall@24_val: 0.0
2024-09-08 15:28:48.296 | INFO     | retrieval.model:validation_step:379 - Recall@25_val: 0.0
2024-09-08 15:28:48.297 | INFO     | retrieval.model:validation_step:379 - Recall@26_val: 0.0
2024-09-08 15:28:48.298 | INFO     | retrieval.model:validation_step:379 - Recall@27_val: 0.0
2024-09-08 15:28:48.299 | INFO     | retrieval.model:validation_step:379 - Recall@28_val: 0.0
2024-09-08 15:28:48.300 | INFO     | retrieval.model:validation_step:379 - Recall@29_val: 0.0
2024-09-08 15:28:48.301 | INFO     | retrieval.model:validation_step:379 - Recall@30_val: 0.0
2024-09-08 15:28:48.301 | INFO     | retrieval.model:validation_step:379 - Recall@31_val: 0.0
2024-09-08 15:28:48.302 | INFO     | retrieval.model:validation_step:379 - Recall@32_val: 0.0
2024-09-08 15:28:48.303 | INFO     | retrieval.model:validation_step:379 - Recall@33_val: 0.0
2024-09-08 15:28:48.304 | INFO     | retrieval.model:validation_step:379 - Recall@34_val: 0.0
2024-09-08 15:28:48.305 | INFO     | retrieval.model:validation_step:379 - Recall@35_val: 0.0
2024-09-08 15:28:48.306 | INFO     | retrieval.model:validation_step:379 - Recall@36_val: 0.0
2024-09-08 15:28:48.307 | INFO     | retrieval.model:validation_step:379 - Recall@37_val: 0.0
2024-09-08 15:28:48.307 | INFO     | retrieval.model:validation_step:379 - Recall@38_val: 0.0
2024-09-08 15:28:48.308 | INFO     | retrieval.model:validation_step:379 - Recall@39_val: 0.0
2024-09-08 15:28:48.309 | INFO     | retrieval.model:validation_step:379 - Recall@40_val: 0.0
2024-09-08 15:28:48.310 | INFO     | retrieval.model:validation_step:379 - Recall@41_val: 0.0
2024-09-08 15:28:48.311 | INFO     | retrieval.model:validation_step:379 - Recall@42_val: 0.0
2024-09-08 15:28:48.312 | INFO     | retrieval.model:validation_step:379 - Recall@43_val: 0.0
2024-09-08 15:28:48.312 | INFO     | retrieval.model:validation_step:379 - Recall@44_val: 0.0
2024-09-08 15:28:48.313 | INFO     | retrieval.model:validation_step:379 - Recall@45_val: 0.0
2024-09-08 15:28:48.314 | INFO     | retrieval.model:validation_step:379 - Recall@46_val: 0.0
2024-09-08 15:28:48.315 | INFO     | retrieval.model:validation_step:379 - Recall@47_val: 0.0
2024-09-08 15:28:48.316 | INFO     | retrieval.model:validation_step:379 - Recall@48_val: 0.0
2024-09-08 15:28:48.317 | INFO     | retrieval.model:validation_step:379 - Recall@49_val: 0.0
2024-09-08 15:28:48.318 | INFO     | retrieval.model:validation_step:379 - Recall@50_val: 0.0
2024-09-08 15:28:48.318 | INFO     | retrieval.model:validation_step:379 - Recall@51_val: 0.0
2024-09-08 15:28:48.319 | INFO     | retrieval.model:validation_step:379 - Recall@52_val: 0.0
2024-09-08 15:28:48.320 | INFO     | retrieval.model:validation_step:379 - Recall@53_val: 0.0
2024-09-08 15:28:48.321 | INFO     | retrieval.model:validation_step:379 - Recall@54_val: 0.0
2024-09-08 15:28:48.322 | INFO     | retrieval.model:validation_step:379 - Recall@55_val: 0.0
2024-09-08 15:28:48.322 | INFO     | retrieval.model:validation_step:379 - Recall@56_val: 0.0
2024-09-08 15:28:48.323 | INFO     | retrieval.model:validation_step:379 - Recall@57_val: 0.0
2024-09-08 15:28:48.324 | INFO     | retrieval.model:validation_step:379 - Recall@58_val: 0.0
2024-09-08 15:28:48.325 | INFO     | retrieval.model:validation_step:379 - Recall@59_val: 0.0
2024-09-08 15:28:48.326 | INFO     | retrieval.model:validation_step:379 - Recall@60_val: 0.0
2024-09-08 15:28:48.327 | INFO     | retrieval.model:validation_step:379 - Recall@61_val: 0.0
2024-09-08 15:28:48.328 | INFO     | retrieval.model:validation_step:379 - Recall@62_val: 0.0
2024-09-08 15:28:48.328 | INFO     | retrieval.model:validation_step:379 - Recall@63_val: 0.0
2024-09-08 15:28:48.329 | INFO     | retrieval.model:validation_step:379 - Recall@64_val: 0.0
2024-09-08 15:28:48.330 | INFO     | retrieval.model:validation_step:379 - Recall@65_val: 0.0
2024-09-08 15:28:48.331 | INFO     | retrieval.model:validation_step:379 - Recall@66_val: 0.0
2024-09-08 15:28:48.332 | INFO     | retrieval.model:validation_step:379 - Recall@67_val: 0.0
2024-09-08 15:28:48.332 | INFO     | retrieval.model:validation_step:379 - Recall@68_val: 0.0
2024-09-08 15:28:48.333 | INFO     | retrieval.model:validation_step:379 - Recall@69_val: 0.0
2024-09-08 15:28:48.334 | INFO     | retrieval.model:validation_step:379 - Recall@70_val: 0.0
2024-09-08 15:28:48.335 | INFO     | retrieval.model:validation_step:379 - Recall@71_val: 0.0
2024-09-08 15:28:48.336 | INFO     | retrieval.model:validation_step:379 - Recall@72_val: 0.0
2024-09-08 15:28:48.337 | INFO     | retrieval.model:validation_step:379 - Recall@73_val: 0.0
2024-09-08 15:28:48.337 | INFO     | retrieval.model:validation_step:379 - Recall@74_val: 0.0
2024-09-08 15:28:48.338 | INFO     | retrieval.model:validation_step:379 - Recall@75_val: 0.0
2024-09-08 15:28:48.339 | INFO     | retrieval.model:validation_step:379 - Recall@76_val: 0.0
2024-09-08 15:28:48.340 | INFO     | retrieval.model:validation_step:379 - Recall@77_val: 0.0
2024-09-08 15:28:48.341 | INFO     | retrieval.model:validation_step:379 - Recall@78_val: 0.0
2024-09-08 15:28:48.342 | INFO     | retrieval.model:validation_step:379 - Recall@79_val: 0.0
2024-09-08 15:28:48.342 | INFO     | retrieval.model:validation_step:379 - Recall@80_val: 0.0
2024-09-08 15:28:48.343 | INFO     | retrieval.model:validation_step:379 - Recall@81_val: 0.0
2024-09-08 15:28:48.344 | INFO     | retrieval.model:validation_step:379 - Recall@82_val: 0.0
2024-09-08 15:28:48.345 | INFO     | retrieval.model:validation_step:379 - Recall@83_val: 0.0
2024-09-08 15:28:48.346 | INFO     | retrieval.model:validation_step:379 - Recall@84_val: 0.0
2024-09-08 15:28:48.346 | INFO     | retrieval.model:validation_step:379 - Recall@85_val: 0.0
2024-09-08 15:28:48.347 | INFO     | retrieval.model:validation_step:379 - Recall@86_val: 0.0
2024-09-08 15:28:48.348 | INFO     | retrieval.model:validation_step:379 - Recall@87_val: 0.0
2024-09-08 15:28:48.349 | INFO     | retrieval.model:validation_step:379 - Recall@88_val: 0.0
2024-09-08 15:28:48.350 | INFO     | retrieval.model:validation_step:379 - Recall@89_val: 0.0
2024-09-08 15:28:48.351 | INFO     | retrieval.model:validation_step:379 - Recall@90_val: 0.0
2024-09-08 15:28:48.351 | INFO     | retrieval.model:validation_step:379 - Recall@91_val: 0.0
2024-09-08 15:28:48.352 | INFO     | retrieval.model:validation_step:379 - Recall@92_val: 0.0
2024-09-08 15:28:48.353 | INFO     | retrieval.model:validation_step:379 - Recall@93_val: 0.0
2024-09-08 15:28:48.354 | INFO     | retrieval.model:validation_step:379 - Recall@94_val: 0.0
2024-09-08 15:28:48.355 | INFO     | retrieval.model:validation_step:379 - Recall@95_val: 0.0
2024-09-08 15:28:48.356 | INFO     | retrieval.model:validation_step:379 - Recall@96_val: 0.0
2024-09-08 15:28:48.356 | INFO     | retrieval.model:validation_step:379 - Recall@97_val: 0.0
2024-09-08 15:28:48.357 | INFO     | retrieval.model:validation_step:379 - Recall@98_val: 0.0
2024-09-08 15:28:48.358 | INFO     | retrieval.model:validation_step:379 - Recall@99_val: 0.0
2024-09-08 15:28:48.359 | INFO     | retrieval.model:validation_step:379 - Recall@100_val: 0.0
2024-09-08 15:28:48.360 | INFO     | retrieval.model:validation_step:388 - MRR: 0.0
2024-09-08 15:28:48.361 | INFO     | retrieval.model:validation_step:396 - End of validation_step
2024-09-08 15:28:48.595 | INFO     | retrieval.model:validation_step:379 - Recall@1_val: 0.0
2024-09-08 15:28:48.598 | INFO     | retrieval.model:validation_step:379 - Recall@2_val: 0.0
2024-09-08 15:28:48.599 | INFO     | retrieval.model:validation_step:379 - Recall@3_val: 0.0
2024-09-08 15:28:48.600 | INFO     | retrieval.model:validation_step:379 - Recall@4_val: 0.0
2024-09-08 15:28:48.600 | INFO     | retrieval.model:validation_step:379 - Recall@5_val: 0.0
2024-09-08 15:28:48.601 | INFO     | retrieval.model:validation_step:379 - Recall@6_val: 0.0
2024-09-08 15:28:48.602 | INFO     | retrieval.model:validation_step:379 - Recall@7_val: 0.0
2024-09-08 15:28:48.603 | INFO     | retrieval.model:validation_step:379 - Recall@8_val: 0.0
2024-09-08 15:28:48.604 | INFO     | retrieval.model:validation_step:379 - Recall@9_val: 0.0
2024-09-08 15:28:48.605 | INFO     | retrieval.model:validation_step:379 - Recall@10_val: 0.0
2024-09-08 15:28:48.605 | INFO     | retrieval.model:validation_step:379 - Recall@11_val: 0.0
2024-09-08 15:28:48.606 | INFO     | retrieval.model:validation_step:379 - Recall@12_val: 0.0
2024-09-08 15:28:48.607 | INFO     | retrieval.model:validation_step:379 - Recall@13_val: 0.0
2024-09-08 15:28:48.608 | INFO     | retrieval.model:validation_step:379 - Recall@14_val: 0.0
2024-09-08 15:28:48.609 | INFO     | retrieval.model:validation_step:379 - Recall@15_val: 0.0
2024-09-08 15:28:48.610 | INFO     | retrieval.model:validation_step:379 - Recall@16_val: 0.0
2024-09-08 15:28:48.611 | INFO     | retrieval.model:validation_step:379 - Recall@17_val: 0.0
2024-09-08 15:28:48.611 | INFO     | retrieval.model:validation_step:379 - Recall@18_val: 0.0
2024-09-08 15:28:48.612 | INFO     | retrieval.model:validation_step:379 - Recall@19_val: 0.0
2024-09-08 15:28:48.613 | INFO     | retrieval.model:validation_step:379 - Recall@20_val: 0.0
2024-09-08 15:28:48.614 | INFO     | retrieval.model:validation_step:379 - Recall@21_val: 0.0
2024-09-08 15:28:48.615 | INFO     | retrieval.model:validation_step:379 - Recall@22_val: 0.0
2024-09-08 15:28:48.615 | INFO     | retrieval.model:validation_step:379 - Recall@23_val: 0.0
2024-09-08 15:28:48.616 | INFO     | retrieval.model:validation_step:379 - Recall@24_val: 0.0
2024-09-08 15:28:48.617 | INFO     | retrieval.model:validation_step:379 - Recall@25_val: 0.0
2024-09-08 15:28:48.618 | INFO     | retrieval.model:validation_step:379 - Recall@26_val: 0.6944444444444444
2024-09-08 15:28:48.619 | INFO     | retrieval.model:validation_step:379 - Recall@27_val: 0.6944444444444444
2024-09-08 15:28:48.619 | INFO     | retrieval.model:validation_step:379 - Recall@28_val: 0.6944444444444444
2024-09-08 15:28:48.620 | INFO     | retrieval.model:validation_step:379 - Recall@29_val: 0.6944444444444444
2024-09-08 15:28:48.621 | INFO     | retrieval.model:validation_step:379 - Recall@30_val: 0.6944444444444444
2024-09-08 15:28:48.622 | INFO     | retrieval.model:validation_step:379 - Recall@31_val: 0.6944444444444444
2024-09-08 15:28:48.623 | INFO     | retrieval.model:validation_step:379 - Recall@32_val: 0.6944444444444444
2024-09-08 15:28:48.624 | INFO     | retrieval.model:validation_step:379 - Recall@33_val: 0.6944444444444444
2024-09-08 15:28:48.624 | INFO     | retrieval.model:validation_step:379 - Recall@34_val: 0.6944444444444444
2024-09-08 15:28:48.625 | INFO     | retrieval.model:validation_step:379 - Recall@35_val: 0.6944444444444444
2024-09-08 15:28:48.626 | INFO     | retrieval.model:validation_step:379 - Recall@36_val: 0.6944444444444444
2024-09-08 15:28:48.627 | INFO     | retrieval.model:validation_step:379 - Recall@37_val: 0.6944444444444444
2024-09-08 15:28:48.628 | INFO     | retrieval.model:validation_step:379 - Recall@38_val: 0.6944444444444444
2024-09-08 15:28:48.628 | INFO     | retrieval.model:validation_step:379 - Recall@39_val: 0.6944444444444444
2024-09-08 15:28:48.629 | INFO     | retrieval.model:validation_step:379 - Recall@40_val: 0.6944444444444444
2024-09-08 15:28:48.630 | INFO     | retrieval.model:validation_step:379 - Recall@41_val: 0.6944444444444444
2024-09-08 15:28:48.631 | INFO     | retrieval.model:validation_step:379 - Recall@42_val: 0.6944444444444444
2024-09-08 15:28:48.632 | INFO     | retrieval.model:validation_step:379 - Recall@43_val: 0.6944444444444444
2024-09-08 15:28:48.632 | INFO     | retrieval.model:validation_step:379 - Recall@44_val: 0.6944444444444444
2024-09-08 15:28:48.633 | INFO     | retrieval.model:validation_step:379 - Recall@45_val: 0.6944444444444444
2024-09-08 15:28:48.634 | INFO     | retrieval.model:validation_step:379 - Recall@46_val: 0.6944444444444444
2024-09-08 15:28:48.635 | INFO     | retrieval.model:validation_step:379 - Recall@47_val: 0.6944444444444444
2024-09-08 15:28:48.636 | INFO     | retrieval.model:validation_step:379 - Recall@48_val: 0.6944444444444444
2024-09-08 15:28:48.636 | INFO     | retrieval.model:validation_step:379 - Recall@49_val: 0.6944444444444444
2024-09-08 15:28:48.637 | INFO     | retrieval.model:validation_step:379 - Recall@50_val: 0.6944444444444444
2024-09-08 15:28:48.638 | INFO     | retrieval.model:validation_step:379 - Recall@51_val: 0.6944444444444444
2024-09-08 15:28:48.639 | INFO     | retrieval.model:validation_step:379 - Recall@52_val: 0.6944444444444444
2024-09-08 15:28:48.640 | INFO     | retrieval.model:validation_step:379 - Recall@53_val: 0.6944444444444444
2024-09-08 15:28:48.640 | INFO     | retrieval.model:validation_step:379 - Recall@54_val: 0.6944444444444444
2024-09-08 15:28:48.641 | INFO     | retrieval.model:validation_step:379 - Recall@55_val: 0.6944444444444444
2024-09-08 15:28:48.642 | INFO     | retrieval.model:validation_step:379 - Recall@56_val: 0.6944444444444444
2024-09-08 15:28:48.643 | INFO     | retrieval.model:validation_step:379 - Recall@57_val: 0.6944444444444444
2024-09-08 15:28:48.644 | INFO     | retrieval.model:validation_step:379 - Recall@58_val: 0.6944444444444444
2024-09-08 15:28:48.644 | INFO     | retrieval.model:validation_step:379 - Recall@59_val: 0.6944444444444444
2024-09-08 15:28:48.645 | INFO     | retrieval.model:validation_step:379 - Recall@60_val: 0.6944444444444444
2024-09-08 15:28:48.646 | INFO     | retrieval.model:validation_step:379 - Recall@61_val: 0.6944444444444444
2024-09-08 15:28:48.647 | INFO     | retrieval.model:validation_step:379 - Recall@62_val: 0.6944444444444444
2024-09-08 15:28:48.648 | INFO     | retrieval.model:validation_step:379 - Recall@63_val: 0.6944444444444444
2024-09-08 15:28:48.648 | INFO     | retrieval.model:validation_step:379 - Recall@64_val: 0.6944444444444444
2024-09-08 15:28:48.649 | INFO     | retrieval.model:validation_step:379 - Recall@65_val: 0.6944444444444444
2024-09-08 15:28:48.650 | INFO     | retrieval.model:validation_step:379 - Recall@66_val: 0.6944444444444444
2024-09-08 15:28:48.651 | INFO     | retrieval.model:validation_step:379 - Recall@67_val: 0.6944444444444444
2024-09-08 15:28:48.652 | INFO     | retrieval.model:validation_step:379 - Recall@68_val: 0.6944444444444444
2024-09-08 15:28:48.652 | INFO     | retrieval.model:validation_step:379 - Recall@69_val: 0.6944444444444444
2024-09-08 15:28:48.653 | INFO     | retrieval.model:validation_step:379 - Recall@70_val: 0.6944444444444444
2024-09-08 15:28:48.654 | INFO     | retrieval.model:validation_step:379 - Recall@71_val: 0.6944444444444444
2024-09-08 15:28:48.655 | INFO     | retrieval.model:validation_step:379 - Recall@72_val: 0.6944444444444444
2024-09-08 15:28:48.656 | INFO     | retrieval.model:validation_step:379 - Recall@73_val: 0.6944444444444444
2024-09-08 15:28:48.656 | INFO     | retrieval.model:validation_step:379 - Recall@74_val: 0.6944444444444444
2024-09-08 15:28:48.657 | INFO     | retrieval.model:validation_step:379 - Recall@75_val: 0.6944444444444444
2024-09-08 15:28:48.658 | INFO     | retrieval.model:validation_step:379 - Recall@76_val: 0.6944444444444444
2024-09-08 15:28:48.659 | INFO     | retrieval.model:validation_step:379 - Recall@77_val: 0.6944444444444444
2024-09-08 15:28:48.660 | INFO     | retrieval.model:validation_step:379 - Recall@78_val: 0.6944444444444444
2024-09-08 15:28:48.660 | INFO     | retrieval.model:validation_step:379 - Recall@79_val: 0.6944444444444444
2024-09-08 15:28:48.661 | INFO     | retrieval.model:validation_step:379 - Recall@80_val: 0.6944444444444444
2024-09-08 15:28:48.662 | INFO     | retrieval.model:validation_step:379 - Recall@81_val: 0.6944444444444444
2024-09-08 15:28:48.663 | INFO     | retrieval.model:validation_step:379 - Recall@82_val: 0.6944444444444444
2024-09-08 15:28:48.663 | INFO     | retrieval.model:validation_step:379 - Recall@83_val: 0.6944444444444444
2024-09-08 15:28:48.664 | INFO     | retrieval.model:validation_step:379 - Recall@84_val: 0.6944444444444444
2024-09-08 15:28:48.665 | INFO     | retrieval.model:validation_step:379 - Recall@85_val: 0.6944444444444444
2024-09-08 15:28:48.666 | INFO     | retrieval.model:validation_step:379 - Recall@86_val: 0.6944444444444444
2024-09-08 15:28:48.667 | INFO     | retrieval.model:validation_step:379 - Recall@87_val: 0.6944444444444444
2024-09-08 15:28:48.668 | INFO     | retrieval.model:validation_step:379 - Recall@88_val: 0.6944444444444444
2024-09-08 15:28:48.668 | INFO     | retrieval.model:validation_step:379 - Recall@89_val: 0.6944444444444444
2024-09-08 15:28:48.669 | INFO     | retrieval.model:validation_step:379 - Recall@90_val: 0.6944444444444444
2024-09-08 15:28:48.670 | INFO     | retrieval.model:validation_step:379 - Recall@91_val: 0.6944444444444444
2024-09-08 15:28:48.671 | INFO     | retrieval.model:validation_step:379 - Recall@92_val: 0.6944444444444444
2024-09-08 15:28:48.672 | INFO     | retrieval.model:validation_step:379 - Recall@93_val: 0.6944444444444444
2024-09-08 15:28:48.672 | INFO     | retrieval.model:validation_step:379 - Recall@94_val: 0.6944444444444444
2024-09-08 15:28:48.673 | INFO     | retrieval.model:validation_step:379 - Recall@95_val: 0.6944444444444444
2024-09-08 15:28:48.674 | INFO     | retrieval.model:validation_step:379 - Recall@96_val: 0.6944444444444444
2024-09-08 15:28:48.675 | INFO     | retrieval.model:validation_step:379 - Recall@97_val: 0.6944444444444444
2024-09-08 15:28:48.676 | INFO     | retrieval.model:validation_step:379 - Recall@98_val: 0.6944444444444444
2024-09-08 15:28:48.676 | INFO     | retrieval.model:validation_step:379 - Recall@99_val: 0.6944444444444444
2024-09-08 15:28:48.677 | INFO     | retrieval.model:validation_step:379 - Recall@100_val: 0.6944444444444444
2024-09-08 15:28:48.678 | INFO     | retrieval.model:validation_step:388 - MRR: 0.0008012820512820514
2024-09-08 15:28:48.679 | INFO     | retrieval.model:validation_step:396 - End of validation_step
                                                                                                                                                                                                                                                   2
024-09-08 15:28:48.705 | INFO     | retrieval.model:validation_step:379 - Recall@1_val: 0.0| 1/1 [00:02<00:00,  0.37it/s]
2024-09-08 15:28:48.708 | INFO     | retrieval.model:validation_step:379 - Recall@2_val: 0.0
2024-09-08 15:28:48.709 | INFO     | retrieval.model:validation_step:379 - Recall@3_val: 0.0
2024-09-08 15:28:48.710 | INFO     | retrieval.model:validation_step:379 - Recall@4_val: 0.0
2024-09-08 15:28:48.711 | INFO     | retrieval.model:validation_step:379 - Recall@5_val: 0.0
2024-09-08 15:28:48.712 | INFO     | retrieval.model:validation_step:379 - Recall@6_val: 0.0
2024-09-08 15:28:48.713 | INFO     | retrieval.model:validation_step:379 - Recall@7_val: 0.0
2024-09-08 15:28:48.714 | INFO     | retrieval.model:validation_step:379 - Recall@8_val: 0.0
2024-09-08 15:28:48.715 | INFO     | retrieval.model:validation_step:379 - Recall@9_val: 0.0
2024-09-08 15:28:48.717 | INFO     | retrieval.model:validation_step:379 - Recall@10_val: 0.0
2024-09-08 15:28:48.718 | INFO     | retrieval.model:validation_step:379 - Recall@11_val: 0.0
2024-09-08 15:28:48.719 | INFO     | retrieval.model:validation_step:379 - Recall@12_val: 0.0
2024-09-08 15:28:48.720 | INFO     | retrieval.model:validation_step:379 - Recall@13_val: 0.0
2024-09-08 15:28:48.721 | INFO     | retrieval.model:validation_step:379 - Recall@14_val: 0.0
2024-09-08 15:28:48.722 | INFO     | retrieval.model:validation_step:379 - Recall@15_val: 0.0
2024-09-08 15:28:48.723 | INFO     | retrieval.model:validation_step:379 - Recall@16_val: 0.0
2024-09-08 15:28:48.724 | INFO     | retrieval.model:validation_step:379 - Recall@17_val: 0.0
2024-09-08 15:28:48.725 | INFO     | retrieval.model:validation_step:379 - Recall@18_val: 0.0
2024-09-08 15:28:48.726 | INFO     | retrieval.model:validation_step:379 - Recall@19_val: 0.0
2024-09-08 15:28:48.727 | INFO     | retrieval.model:validation_step:379 - Recall@20_val: 0.0
2024-09-08 15:28:48.728 | INFO     | retrieval.model:validation_step:379 - Recall@21_val: 0.0
2024-09-08 15:28:48.729 | INFO     | retrieval.model:validation_step:379 - Recall@22_val: 0.0
2024-09-08 15:28:48.731 | INFO     | retrieval.model:validation_step:379 - Recall@23_val: 0.0
2024-09-08 15:28:48.731 | INFO     | retrieval.model:validation_step:379 - Recall@1_val: 0.0
2024-09-08 15:28:48.732 | INFO     | retrieval.model:validation_step:379 - Recall@24_val: 0.0
2024-09-08 15:28:48.733 | INFO     | retrieval.model:validation_step:379 - Recall@25_val: 0.0
2024-09-08 15:28:48.734 | INFO     | retrieval.model:validation_step:379 - Recall@26_val: 1.1111111111111112
2024-09-08 15:28:48.734 | INFO     | retrieval.model:validation_step:379 - Recall@2_val: 0.0
2024-09-08 15:28:48.736 | INFO     | retrieval.model:validation_step:379 - Recall@27_val: 1.1111111111111112
2024-09-08 15:28:48.736 | INFO     | retrieval.model:validation_step:379 - Recall@3_val: 0.0
2024-09-08 15:28:48.737 | INFO     | retrieval.model:validation_step:379 - Recall@28_val: 1.1111111111111112
2024-09-08 15:28:48.737 | INFO     | retrieval.model:validation_step:379 - Recall@4_val: 0.0
2024-09-08 15:28:48.738 | INFO     | retrieval.model:validation_step:379 - Recall@29_val: 1.1111111111111112
2024-09-08 15:28:48.738 | INFO     | retrieval.model:validation_step:379 - Recall@5_val: 0.0
2024-09-08 15:28:48.739 | INFO     | retrieval.model:validation_step:379 - Recall@30_val: 1.1111111111111112
2024-09-08 15:28:48.739 | INFO     | retrieval.model:validation_step:379 - Recall@6_val: 0.0
2024-09-08 15:28:48.740 | INFO     | retrieval.model:validation_step:379 - Recall@31_val: 1.1111111111111112
2024-09-08 15:28:48.741 | INFO     | retrieval.model:validation_step:379 - Recall@7_val: 0.0
2024-09-08 15:28:48.742 | INFO     | retrieval.model:validation_step:379 - Recall@32_val: 1.1111111111111112
2024-09-08 15:28:48.742 | INFO     | retrieval.model:validation_step:379 - Recall@8_val: 0.0
2024-09-08 15:28:48.743 | INFO     | retrieval.model:validation_step:379 - Recall@33_val: 1.1111111111111112
2024-09-08 15:28:48.743 | INFO     | retrieval.model:validation_step:379 - Recall@9_val: 0.0
2024-09-08 15:28:48.744 | INFO     | retrieval.model:validation_step:379 - Recall@34_val: 1.1111111111111112
2024-09-08 15:28:48.744 | INFO     | retrieval.model:validation_step:379 - Recall@10_val: 0.0
2024-09-08 15:28:48.745 | INFO     | retrieval.model:validation_step:379 - Recall@35_val: 1.1111111111111112
2024-09-08 15:28:48.746 | INFO     | retrieval.model:validation_step:379 - Recall@11_val: 0.0
2024-09-08 15:28:48.747 | INFO     | retrieval.model:validation_step:379 - Recall@36_val: 1.1111111111111112
2024-09-08 15:28:48.747 | INFO     | retrieval.model:validation_step:379 - Recall@12_val: 0.0
2024-09-08 15:28:48.748 | INFO     | retrieval.model:validation_step:379 - Recall@13_val: 0.0
2024-09-08 15:28:48.748 | INFO     | retrieval.model:validation_step:379 - Recall@37_val: 1.1111111111111112
2024-09-08 15:28:48.749 | INFO     | retrieval.model:validation_step:379 - Recall@14_val: 0.0
2024-09-08 15:28:48.749 | INFO     | retrieval.model:validation_step:379 - Recall@38_val: 1.1111111111111112
2024-09-08 15:28:48.750 | INFO     | retrieval.model:validation_step:379 - Recall@15_val: 0.0
2024-09-08 15:28:48.750 | INFO     | retrieval.model:validation_step:379 - Recall@39_val: 1.1111111111111112
2024-09-08 15:28:48.751 | INFO     | retrieval.model:validation_step:379 - Recall@40_val: 3.3333333333333335
2024-09-08 15:28:48.751 | INFO     | retrieval.model:validation_step:379 - Recall@16_val: 0.0
2024-09-08 15:28:48.753 | INFO     | retrieval.model:validation_step:379 - Recall@41_val: 3.3333333333333335
2024-09-08 15:28:48.753 | INFO     | retrieval.model:validation_step:379 - Recall@17_val: 0.0
2024-09-08 15:28:48.754 | INFO     | retrieval.model:validation_step:379 - Recall@18_val: 0.0
2024-09-08 15:28:48.754 | INFO     | retrieval.model:validation_step:379 - Recall@42_val: 3.3333333333333335
2024-09-08 15:28:48.755 | INFO     | retrieval.model:validation_step:379 - Recall@19_val: 0.0
2024-09-08 15:28:48.755 | INFO     | retrieval.model:validation_step:379 - Recall@43_val: 3.3333333333333335
2024-09-08 15:28:48.756 | INFO     | retrieval.model:validation_step:379 - Recall@44_val: 3.3333333333333335
2024-09-08 15:28:48.756 | INFO     | retrieval.model:validation_step:379 - Recall@20_val: 0.0
2024-09-08 15:28:48.757 | INFO     | retrieval.model:validation_step:379 - Recall@45_val: 3.3333333333333335
2024-09-08 15:28:48.757 | INFO     | retrieval.model:validation_step:379 - Recall@21_val: 0.0
2024-09-08 15:28:48.758 | INFO     | retrieval.model:validation_step:379 - Recall@46_val: 3.3333333333333335
2024-09-08 15:28:48.758 | INFO     | retrieval.model:validation_step:379 - Recall@22_val: 0.0
2024-09-08 15:28:48.760 | INFO     | retrieval.model:validation_step:379 - Recall@47_val: 3.3333333333333335
2024-09-08 15:28:48.760 | INFO     | retrieval.model:validation_step:379 - Recall@23_val: 0.9803921568627451
2024-09-08 15:28:48.761 | INFO     | retrieval.model:validation_step:379 - Recall@48_val: 3.3333333333333335
2024-09-08 15:28:48.761 | INFO     | retrieval.model:validation_step:379 - Recall@24_val: 0.9803921568627451
2024-09-08 15:28:48.762 | INFO     | retrieval.model:validation_step:379 - Recall@25_val: 0.9803921568627451
2024-09-08 15:28:48.762 | INFO     | retrieval.model:validation_step:379 - Recall@49_val: 3.3333333333333335
2024-09-08 15:28:48.763 | INFO     | retrieval.model:validation_step:379 - Recall@26_val: 2.124183006535948
2024-09-08 15:28:48.763 | INFO     | retrieval.model:validation_step:379 - Recall@50_val: 3.3333333333333335
2024-09-08 15:28:48.764 | INFO     | retrieval.model:validation_step:379 - Recall@27_val: 2.124183006535948
2024-09-08 15:28:48.764 | INFO     | retrieval.model:validation_step:379 - Recall@51_val: 3.3333333333333335
2024-09-08 15:28:48.765 | INFO     | retrieval.model:validation_step:379 - Recall@52_val: 3.3333333333333335
2024-09-08 15:28:48.765 | INFO     | retrieval.model:validation_step:379 - Recall@28_val: 2.124183006535948
2024-09-08 15:28:48.767 | INFO     | retrieval.model:validation_step:379 - Recall@53_val: 3.3333333333333335
2024-09-08 15:28:48.767 | INFO     | retrieval.model:validation_step:379 - Recall@29_val: 2.124183006535948
2024-09-08 15:28:48.768 | INFO     | retrieval.model:validation_step:379 - Recall@54_val: 3.3333333333333335
2024-09-08 15:28:48.768 | INFO     | retrieval.model:validation_step:379 - Recall@30_val: 2.124183006535948
2024-09-08 15:28:48.769 | INFO     | retrieval.model:validation_step:379 - Recall@55_val: 3.3333333333333335
2024-09-08 15:28:48.769 | INFO     | retrieval.model:validation_step:379 - Recall@31_val: 2.124183006535948
2024-09-08 15:28:48.770 | INFO     | retrieval.model:validation_step:379 - Recall@32_val: 2.124183006535948
2024-09-08 15:28:48.770 | INFO     | retrieval.model:validation_step:379 - Recall@56_val: 3.3333333333333335
2024-09-08 15:28:48.771 | INFO     | retrieval.model:validation_step:379 - Recall@33_val: 2.124183006535948
2024-09-08 15:28:48.771 | INFO     | retrieval.model:validation_step:379 - Recall@57_val: 3.3333333333333335
2024-09-08 15:28:48.772 | INFO     | retrieval.model:validation_step:379 - Recall@34_val: 2.124183006535948
2024-09-08 15:28:48.772 | INFO     | retrieval.model:validation_step:379 - Recall@58_val: 3.3333333333333335
2024-09-08 15:28:48.774 | INFO     | retrieval.model:validation_step:379 - Recall@35_val: 2.124183006535948
2024-09-08 15:28:48.774 | INFO     | retrieval.model:validation_step:379 - Recall@59_val: 3.3333333333333335
2024-09-08 15:28:48.775 | INFO     | retrieval.model:validation_step:379 - Recall@60_val: 3.888888888888889
2024-09-08 15:28:48.775 | INFO     | retrieval.model:validation_step:379 - Recall@36_val: 2.124183006535948
2024-09-08 15:28:48.776 | INFO     | retrieval.model:validation_step:379 - Recall@61_val: 3.888888888888889
2024-09-08 15:28:48.776 | INFO     | retrieval.model:validation_step:379 - Recall@37_val: 2.124183006535948
2024-09-08 15:28:48.777 | INFO     | retrieval.model:validation_step:379 - Recall@62_val: 3.888888888888889
2024-09-08 15:28:48.777 | INFO     | retrieval.model:validation_step:379 - Recall@38_val: 2.124183006535948
2024-09-08 15:28:48.779 | INFO     | retrieval.model:validation_step:379 - Recall@39_val: 2.124183006535948
2024-09-08 15:28:48.779 | INFO     | retrieval.model:validation_step:379 - Recall@63_val: 3.888888888888889
2024-09-08 15:28:48.780 | INFO     | retrieval.model:validation_step:379 - Recall@64_val: 3.888888888888889
2024-09-08 15:28:48.780 | INFO     | retrieval.model:validation_step:379 - Recall@40_val: 2.124183006535948
2024-09-08 15:28:48.781 | INFO     | retrieval.model:validation_step:379 - Recall@41_val: 2.124183006535948
2024-09-08 15:28:48.781 | INFO     | retrieval.model:validation_step:379 - Recall@65_val: 3.888888888888889
2024-09-08 15:28:48.782 | INFO     | retrieval.model:validation_step:379 - Recall@66_val: 3.888888888888889
2024-09-08 15:28:48.782 | INFO     | retrieval.model:validation_step:379 - Recall@42_val: 2.124183006535948
2024-09-08 15:28:48.783 | INFO     | retrieval.model:validation_step:379 - Recall@43_val: 2.124183006535948
2024-09-08 15:28:48.783 | INFO     | retrieval.model:validation_step:379 - Recall@67_val: 3.888888888888889
2024-09-08 15:28:48.784 | INFO     | retrieval.model:validation_step:379 - Recall@44_val: 2.124183006535948
2024-09-08 15:28:48.784 | INFO     | retrieval.model:validation_step:379 - Recall@68_val: 3.888888888888889
2024-09-08 15:28:48.786 | INFO     | retrieval.model:validation_step:379 - Recall@45_val: 2.124183006535948
2024-09-08 15:28:48.786 | INFO     | retrieval.model:validation_step:379 - Recall@69_val: 3.888888888888889
2024-09-08 15:28:48.787 | INFO     | retrieval.model:validation_step:379 - Recall@70_val: 3.888888888888889
2024-09-08 15:28:48.787 | INFO     | retrieval.model:validation_step:379 - Recall@46_val: 2.124183006535948
2024-09-08 15:28:48.788 | INFO     | retrieval.model:validation_step:379 - Recall@71_val: 3.888888888888889
2024-09-08 15:28:48.788 | INFO     | retrieval.model:validation_step:379 - Recall@47_val: 2.124183006535948
2024-09-08 15:28:48.789 | INFO     | retrieval.model:validation_step:379 - Recall@72_val: 3.888888888888889
2024-09-08 15:28:48.789 | INFO     | retrieval.model:validation_step:379 - Recall@48_val: 2.124183006535948
2024-09-08 15:28:48.790 | INFO     | retrieval.model:validation_step:379 - Recall@73_val: 3.888888888888889
2024-09-08 15:28:48.790 | INFO     | retrieval.model:validation_step:379 - Recall@49_val: 2.124183006535948
2024-09-08 15:28:48.791 | INFO     | retrieval.model:validation_step:379 - Recall@50_val: 2.124183006535948
2024-09-08 15:28:48.791 | INFO     | retrieval.model:validation_step:379 - Recall@74_val: 3.888888888888889
2024-09-08 15:28:48.793 | INFO     | retrieval.model:validation_step:379 - Recall@51_val: 2.124183006535948
2024-09-08 15:28:48.793 | INFO     | retrieval.model:validation_step:379 - Recall@75_val: 3.888888888888889
2024-09-08 15:28:48.794 | INFO     | retrieval.model:validation_step:379 - Recall@52_val: 2.124183006535948
2024-09-08 15:28:48.794 | INFO     | retrieval.model:validation_step:379 - Recall@76_val: 3.888888888888889
2024-09-08 15:28:48.795 | INFO     | retrieval.model:validation_step:379 - Recall@77_val: 3.888888888888889
2024-09-08 15:28:48.795 | INFO     | retrieval.model:validation_step:379 - Recall@53_val: 2.124183006535948
2024-09-08 15:28:48.796 | INFO     | retrieval.model:validation_step:379 - Recall@54_val: 2.124183006535948
2024-09-08 15:28:48.796 | INFO     | retrieval.model:validation_step:379 - Recall@78_val: 3.888888888888889
2024-09-08 15:28:48.797 | INFO     | retrieval.model:validation_step:379 - Recall@55_val: 2.124183006535948
2024-09-08 15:28:48.797 | INFO     | retrieval.model:validation_step:379 - Recall@79_val: 3.888888888888889
2024-09-08 15:28:48.798 | INFO     | retrieval.model:validation_step:379 - Recall@56_val: 2.124183006535948
2024-09-08 15:28:48.798 | INFO     | retrieval.model:validation_step:379 - Recall@80_val: 3.888888888888889
2024-09-08 15:28:48.800 | INFO     | retrieval.model:validation_step:379 - Recall@81_val: 3.888888888888889
2024-09-08 15:28:48.800 | INFO     | retrieval.model:validation_step:379 - Recall@57_val: 2.124183006535948
2024-09-08 15:28:48.801 | INFO     | retrieval.model:validation_step:379 - Recall@58_val: 2.124183006535948
2024-09-08 15:28:48.801 | INFO     | retrieval.model:validation_step:379 - Recall@82_val: 3.888888888888889
2024-09-08 15:28:48.802 | INFO     | retrieval.model:validation_step:379 - Recall@83_val: 3.888888888888889
2024-09-08 15:28:48.802 | INFO     | retrieval.model:validation_step:379 - Recall@59_val: 2.124183006535948
2024-09-08 15:28:48.803 | INFO     | retrieval.model:validation_step:379 - Recall@60_val: 2.124183006535948
2024-09-08 15:28:48.803 | INFO     | retrieval.model:validation_step:379 - Recall@84_val: 3.888888888888889
2024-09-08 15:28:48.804 | INFO     | retrieval.model:validation_step:379 - Recall@61_val: 2.124183006535948
2024-09-08 15:28:48.804 | INFO     | retrieval.model:validation_step:379 - Recall@85_val: 3.888888888888889
2024-09-08 15:28:48.805 | INFO     | retrieval.model:validation_step:379 - Recall@86_val: 3.888888888888889
2024-09-08 15:28:48.806 | INFO     | retrieval.model:validation_step:379 - Recall@62_val: 2.124183006535948
2024-09-08 15:28:48.807 | INFO     | retrieval.model:validation_step:379 - Recall@87_val: 3.888888888888889
2024-09-08 15:28:48.807 | INFO     | retrieval.model:validation_step:379 - Recall@63_val: 2.124183006535948
2024-09-08 15:28:48.808 | INFO     | retrieval.model:validation_step:379 - Recall@64_val: 2.124183006535948
2024-09-08 15:28:48.808 | INFO     | retrieval.model:validation_step:379 - Recall@88_val: 3.888888888888889
2024-09-08 15:28:48.809 | INFO     | retrieval.model:validation_step:379 - Recall@89_val: 3.888888888888889
2024-09-08 15:28:48.809 | INFO     | retrieval.model:validation_step:379 - Recall@65_val: 2.124183006535948
2024-09-08 15:28:48.810 | INFO     | retrieval.model:validation_step:379 - Recall@90_val: 3.888888888888889
2024-09-08 15:28:48.810 | INFO     | retrieval.model:validation_step:379 - Recall@66_val: 2.124183006535948
2024-09-08 15:28:48.811 | INFO     | retrieval.model:validation_step:379 - Recall@91_val: 3.888888888888889
2024-09-08 15:28:48.811 | INFO     | retrieval.model:validation_step:379 - Recall@67_val: 2.124183006535948
2024-09-08 15:28:48.813 | INFO     | retrieval.model:validation_step:379 - Recall@68_val: 2.124183006535948
2024-09-08 15:28:48.813 | INFO     | retrieval.model:validation_step:379 - Recall@92_val: 3.888888888888889
2024-09-08 15:28:48.814 | INFO     | retrieval.model:validation_step:379 - Recall@93_val: 3.888888888888889
2024-09-08 15:28:48.814 | INFO     | retrieval.model:validation_step:379 - Recall@69_val: 2.124183006535948
2024-09-08 15:28:48.815 | INFO     | retrieval.model:validation_step:379 - Recall@70_val: 2.124183006535948
2024-09-08 15:28:48.815 | INFO     | retrieval.model:validation_step:379 - Recall@94_val: 3.888888888888889
2024-09-08 15:28:48.816 | INFO     | retrieval.model:validation_step:379 - Recall@71_val: 2.124183006535948
2024-09-08 15:28:48.816 | INFO     | retrieval.model:validation_step:379 - Recall@95_val: 3.888888888888889
2024-09-08 15:28:48.817 | INFO     | retrieval.model:validation_step:379 - Recall@72_val: 2.124183006535948
2024-09-08 15:28:48.817 | INFO     | retrieval.model:validation_step:379 - Recall@96_val: 3.888888888888889
2024-09-08 15:28:48.818 | INFO     | retrieval.model:validation_step:379 - Recall@97_val: 3.888888888888889
2024-09-08 15:28:48.818 | INFO     | retrieval.model:validation_step:379 - Recall@73_val: 2.124183006535948
2024-09-08 15:28:48.820 | INFO     | retrieval.model:validation_step:379 - Recall@74_val: 2.124183006535948
2024-09-08 15:28:48.820 | INFO     | retrieval.model:validation_step:379 - Recall@98_val: 3.888888888888889
2024-09-08 15:28:48.821 | INFO     | retrieval.model:validation_step:379 - Recall@99_val: 3.888888888888889
2024-09-08 15:28:48.821 | INFO     | retrieval.model:validation_step:379 - Recall@75_val: 2.124183006535948
2024-09-08 15:28:48.822 | INFO     | retrieval.model:validation_step:379 - Recall@100_val: 3.888888888888889
2024-09-08 15:28:48.822 | INFO     | retrieval.model:validation_step:379 - Recall@76_val: 2.124183006535948
2024-09-08 15:28:48.823 | INFO     | retrieval.model:validation_step:388 - MRR: 0.0023361823361823363
2024-09-08 15:28:48.823 | INFO     | retrieval.model:validation_step:379 - Recall@77_val: 2.124183006535948
2024-09-08 15:28:48.825 | INFO     | retrieval.model:validation_step:379 - Recall@78_val: 2.124183006535948
2024-09-08 15:28:48.825 | INFO     | retrieval.model:validation_step:396 - End of validation_step
2024-09-08 15:28:48.826 | INFO     | retrieval.model:validation_step:379 - Recall@79_val: 2.124183006535948
2024-09-08 15:28:48.827 | INFO     | retrieval.model:validation_step:379 - Recall@80_val: 2.124183006535948
2024-09-08 15:28:48.828 | INFO     | retrieval.model:validation_step:379 - Recall@81_val: 2.124183006535948
2024-09-08 15:28:48.829 | INFO     | retrieval.model:validation_step:379 - Recall@82_val: 2.124183006535948
2024-09-08 15:28:48.830 | INFO     | retrieval.model:validation_step:379 - Recall@83_val: 2.124183006535948
2024-09-08 15:28:48.831 | INFO     | retrieval.model:validation_step:379 - Recall@84_val: 2.124183006535948
2024-09-08 15:28:48.832 | INFO     | retrieval.model:validation_step:379 - Recall@85_val: 2.124183006535948
2024-09-08 15:28:48.834 | INFO     | retrieval.model:validation_step:379 - Recall@86_val: 2.124183006535948
2024-09-08 15:28:48.835 | INFO     | retrieval.model:validation_step:379 - Recall@87_val: 2.124183006535948
2024-09-08 15:28:48.836 | INFO     | retrieval.model:validation_step:379 - Recall@88_val: 2.124183006535948
2024-09-08 15:28:48.837 | INFO     | retrieval.model:validation_step:379 - Recall@89_val: 2.124183006535948
2024-09-08 15:28:48.838 | INFO     | retrieval.model:validation_step:379 - Recall@90_val: 2.124183006535948
2024-09-08 15:28:48.839 | INFO     | retrieval.model:validation_step:379 - Recall@91_val: 4.084967320261438
2024-09-08 15:28:48.840 | INFO     | retrieval.model:validation_step:379 - Recall@92_val: 4.084967320261438
2024-09-08 15:28:48.841 | INFO     | retrieval.model:validation_step:379 - Recall@93_val: 4.084967320261438
2024-09-08 15:28:48.842 | INFO     | retrieval.model:validation_step:379 - Recall@94_val: 4.084967320261438
2024-09-08 15:28:48.843 | INFO     | retrieval.model:validation_step:379 - Recall@95_val: 4.084967320261438
2024-09-08 15:28:48.844 | INFO     | retrieval.model:validation_step:379 - Recall@96_val: 4.084967320261438
2024-09-08 15:28:48.845 | INFO     | retrieval.model:validation_step:379 - Recall@97_val: 4.084967320261438
2024-09-08 15:28:48.846 | INFO     | retrieval.model:validation_step:379 - Recall@98_val: 4.084967320261438
2024-09-08 15:28:48.847 | INFO     | retrieval.model:validation_step:379 - Recall@99_val: 4.084967320261438
2024-09-08 15:28:48.848 | INFO     | retrieval.model:validation_step:379 - Recall@100_val: 4.084967320261438
2024-09-08 15:28:48.849 | INFO     | retrieval.model:validation_step:388 - MRR: 0.002576281348659865
2024-09-08 15:28:48.850 | INFO     | retrieval.model:validation_step:396 - End of validation_step
Epoch 0: 100%|| 2/2 [00:05<00:00,  0.40it/s, v_num=17106]
[rank: 0] Metric Recall@10_val improved. New best score: 0.000
[rank: 2] Metric Recall@10_val improved. New best score: 0.000
[rank: 3] Metric Recall@10_val improved. New best score: 0.000
[rank: 1] Metric Recall@10_val improved. New best score: 0.000
Epoch 0, global step 1: 'Recall@10_val' reached 0.00000 (best 0.00000), saving model to '/data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-R
ecall@10_val=0.00.ckpt' as top 1
`Trainer.fit` stopped: `max_epochs=1` reached.
Epoch 0: 100%|| 2/2 [00:08<00:00,  0.24it/s, v_num=17106]
2024-09-08 15:28:53.875 | INFO     | __main__:main:1470 - hit the barrier after training
2024-09-08 15:28:53.926 | INFO     | __main__:main:1470 - hit the barrier after training
2024-09-08 15:28:54.179 | INFO     | __main__:main:1470 - hit the barrier after training
2024-09-08 15:28:54.221 | INFO     | __main__:main:1470 - hit the barrier after training
2024-09-08 15:28:54.221 | INFO     | __main__:main:1476 - Finished progressive training at epoch 1
2024-09-08 15:28:54.221 | INFO     | __main__:main:1476 - Finished progressive training at epoch 1
2024-09-08 15:28:54.221 | INFO     | __main__:main:1476 - Finished progressive training at epoch 1
2024-09-08 15:28:54.221 | INFO     | __main__:main:1476 - Finished progressive training at epoch 1
2024-09-08 15:28:56.216 | INFO     | __main__:main:1495 - Testing...
2024-09-08 15:28:56.217 | INFO     | retrieval.main:run_cli:60 - PID: 920552
2024-09-08 15:28:56.258 | INFO     | __main__:main:1495 - Testing...
2024-09-08 15:28:56.265 | INFO     | retrieval.main:run_cli:60 - PID: 920551
[rank: 3] Seed set to 3407
2024-09-08 15:28:56.412 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-08 15:28:56.412 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-08 15:28:56.446 | INFO     | __main__:main:1495 - Testing...
2024-09-08 15:28:56.447 | INFO     | retrieval.main:run_cli:60 - PID: 920550
[rank: 2] Seed set to 3407
2024-09-08 15:28:56.453 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-08 15:28:56.454 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-08 15:28:56.536 | INFO     | __main__:main:1495 - Testing...
2024-09-08 15:28:56.538 | INFO     | retrieval.main:run_cli:60 - PID: 920433
[rank: 1] Seed set to 3407
2024-09-08 15:28:56.732 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-08 15:28:56.733 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-08 15:28:56.796 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random
2024-09-08 15:28:56.796 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted
in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
2024-09-08 15:28:56.920 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-08 15:28:56.949 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-08 15:28:57.254 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
2024-09-08 15:28:57.363 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/corpus.jsonl
[rank: 2] Seed set to 3407
[rank: 3] Seed set to 3407
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prep
end your python command with `srun` like so: srun python main.py predict --config retrieval/confs/cli_lean4_r ...
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 1] Seed set to 3407
2024-09-08 15:29:12.278 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 15:29:12.281 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 15:29:12.294 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 15:29:12.295 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 15:29:13.253 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 15:29:13.271 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_pred/cached_data.pkl
Testing dataset size: 2685
2024-09-08 15:29:13.850 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_train/cached_data.pkl
Training dataset size: 169441
2024-09-08 15:29:13.874 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/
cache_pred/cached_data.pkl
Testing dataset size: 2685
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
2024-09-08 15:29:16.777 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
2024-09-08 15:29:16.798 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
2024-09-08 15:29:17.005 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-09-08 15:29:17.050 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
Predicting DataLoader 0:   0%|                                                                                                                                                                                               | 0/11 [00:00<?, ?it/s]
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/loops/prediction_loop.py:255: predict returned None if it was on purpose, ignore this warning...
Predicting DataLoader 0: 100%|| 11/11 [00:26<00:00,  0.42it/s]
2024-09-08 15:29:43.390 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-08 15:29:43.402 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_0.pkl
2024-09-08 15:29:43.402 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-08 15:29:47.226 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-08 15:29:47.243 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_1.pkl
2024-09-08 15:29:47.244 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-08 15:29:48.063 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-08 15:29:48.063 | INFO     | retrieval.model:on_predict_epoch_end:517 - About to construct predictions map
2024-09-08 15:29:48.076 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_3.pkl
2024-09-08 15:29:48.076 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-08 15:29:48.080 | INFO     | retrieval.model:on_predict_epoch_end:537 - Retrieval predictions saved to test_pickle_2.pkl
2024-09-08 15:29:48.080 | INFO     | retrieval.model:on_predict_epoch_end:576 - About to call barrier
2024-09-08 15:29:48.080 | INFO     | retrieval.model:on_predict_epoch_end:580 - All GPUs have completed their predictions and saved the data.
Predicting DataLoader 0: 100%|| 11/11 [00:30<00:00,  0.36it/s]
2024-09-08 15:29:48.804 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 15:29:48.868 | INFO     | __main__:main:1516 - Loaded the predictions pickle files
2024-09-08 15:29:48.875 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 15:29:48.892 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 15:29:48.906 | INFO     | __main__:main:1519 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.json
  0%|                                                                                                                                                                                                                      | 0/1486 [00:00<?, ?it/s]
2024-09-08 15:29:48.922 | INFO     | retrieval.main:run_cli:64 - Configuration:

2024-09-08 15:29:48.925 | INFO     | __main__:main:1516 - Loaded the predictions pickle files
2024-09-08 15:29:48.949 | INFO     | __main__:main:1516 - Loaded the predictions pickle files
2024-09-08 15:29:48.962 | INFO     | __main__:main:1516 - Loaded the predictions pickle files
2024-09-08 15:29:48.973 | INFO     | __main__:main:1519 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.json
100%|| 1486/1486 [00:00<00:00, 24444.69it/s]
2024-09-08 15:29:48.982 | INFO     | __main__:main:1521 - R@1 = 0.02932551319648094 %, R@10 = 0.15891635246473956 %, MRR = 0.003722881573003461
2024-09-08 15:29:48.982 | INFO     | retrieval.main:run_cli:60 - PID: 920552
2024-09-08 15:29:48.992 | INFO     | __main__:main:1519 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.json
2024-09-08 15:29:48.997 | INFO     | __main__:main:1519 - Evaluating on /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687/random/test.json
100%|| 1486/1486 [00:00<00:00, 25184.20it/s]
2024-09-08 15:29:49.073 | INFO     | __main__:main:1521 - R@1 = 0.02932551319648094 %, R@10 = 0.15891635246473956 %, MRR = 0.003722881573003461
 99%| | 1474/1486 [00:00<00:00, 14726.95it/s]
2024-09-08 15:29:49.074 | INFO     | retrieval.main:run_cli:60 - PID: 920433
100%|| 1486/1486 [00:00<00:00, 14689.49it/s]
2024-09-08 15:29:49.075 | INFO     | __main__:main:1521 - R@1 = 0.02932551319648094 %, R@10 = 0.15891635246473956 %, MRR = 0.003722881573003461
2024-09-08 15:29:49.076 | INFO     | retrieval.main:run_cli:60 - PID: 920551
100%|| 1486/1486 [00:00<00:00, 14525.20it/s]
2024-09-08 15:29:49.101 | INFO     | __main__:main:1521 - R@1 = 0.02932551319648094 %, R@10 = 0.15891635246473956 %, MRR = 0.003722881573003461
2024-09-08 15:29:49.101 | INFO     | retrieval.main:run_cli:60 - PID: 920550
[rank: 3] Seed set to 3407
2024-09-08 15:29:49.171 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566
/random
2024-09-08 15:29:49.171 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d5
66/corpus.jsonl
[rank: 0] Seed set to 3407
2024-09-08 15:29:49.259 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566
/random
2024-09-08 15:29:49.259 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d5
66/corpus.jsonl
[rank: 2] Seed set to 3407
2024-09-08 15:29:49.342 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566
/random
2024-09-08 15:29:49.342 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d5
66/corpus.jsonl
[rank: 1] Seed set to 3407
2024-09-08 15:29:49.366 | INFO     | retrieval.main:before_instantiate_classes:33 - Data path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566
/random
2024-09-08 15:29:49.366 | INFO     | retrieval.main:before_instantiate_classes:34 - Corpus path: /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d5
66/corpus.jsonl
2024-09-08 15:29:49.698 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/corpus.jso
nl
2024-09-08 15:29:49.765 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/corpus.jso
nl
2024-09-08 15:29:49.888 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/corpus.jso
nl
2024-09-08 15:29:49.895 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/corpus.jso
nl
[rank: 3] Seed set to 3407
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 3407
[rank: 2] Seed set to 3407
[rank: 1] Seed set to 3407
2024-09-08 15:30:08.273 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916a
e24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195217
2024-09-08 15:30:08.294 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916a
e24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 15:30:09.259 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916a
e24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195217
2024-09-08 15:30:09.273 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916a
e24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 15:30:09.507 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916a
e24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195217
2024-09-08 15:30:09.523 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916a
e24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
2024-09-08 15:30:10.034 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916a
e24253d566/random/cache_train/cached_data.pkl
Training dataset size: 195217
2024-09-08 15:30:10.048 | INFO     | retrieval.datamodule:load_or_cache_data:52 - Loaded data from cache /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916a
e24253d566/random/cache_pred/cached_data.pkl
Testing dataset size: 2723
Restoring states from the checkpoint path at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Loaded model weights from the checkpoint at /data/yingzi_ma/lean_project/checkpoints_retrieval_single_repo_no_ewc_pfr/merged_with_new_pfr_fa398a5b853c7e94e3294c45e50c6aee013a2687_lambda_0.1_epoch=0-Recall@10_val=0.00.ckpt
2024-09-08 15:30:12.437 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
2024-09-08 15:30:12.474 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
Predicting: |                                                                                                                                                                                                                 | 0/? [00:00<?, ?it/s]
2024-09-08 15:30:12.542 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
2024-09-08 15:30:12.561 | INFO     | retrieval.model:on_predict_start:407 - Embeddings staled on predict start: True
Predicting DataLoader 0:  55%|                                                                                   | 6/11 [00:16<00:14,  0.35it/s]
^Z
[29]+  Stopped                 bash run_code.sh
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 15:39:30,228] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 15:39:34.011 | INFO     | __main__:main:1145 - Running retrieval baseline
2024-09-08 15:39:34.011 | INFO     | __main__:main:1148 - Configuring LeanDojo...
2024-09-08 15:39:34.014 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 15:39:34.014 | INFO     | __main__:main:1150 - LeanDojo configured
2024-09-08 15:39:34.014 | INFO     | __main__:main:1155 - Starting the main process
2024-09-08 15:39:34.014 | INFO     | __main__:main:1163 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_PT_single_repo_no_ewc_pfr.json
2024-09-08 15:39:48.537 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 15:39:48.538 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 15:39:53.994 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-09-08 15:39:53.995 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-09-08 15:39:54.224 | INFO     | __main__:main:1165 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_PT_single_repo_no_ewc_pfr.json
2024-09-08 15:39:54.225 | INFO     | __main__:main:1172 - Found 15 repositories
2024-09-08 15:39:54.225 | INFO     | __main__:main:1263 - Starting without curriculum learning
2024-09-08 15:39:54.225 | INFO     | __main__:main:1631 - An error occurred: AlexKontorovich/PrimeNumberTheoremAnd is not a Github URL
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1271, in main
    lean_git_repo = LeanGitRepo(url, commit)
  File "<string>", line 5, in __init__
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/data_extraction/lean.py", line 420, in __post_init__
    raise ValueError(f"{self.url} is not a Github URL")
ValueError: AlexKontorovich/PrimeNumberTheoremAnd is not a Github URL
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
^Z
[30]+  Stopped                 bash run_code.sh
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$ bash run_code.sh
Script executed from: /data/yingzi_ma/lean_project/ReProver
[2024-09-08 15:40:13,189] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2024-09-08 15:40:16.994 | INFO     | __main__:main:1145 - Running retrieval baseline
2024-09-08 15:40:16.994 | INFO     | __main__:main:1148 - Configuring LeanDojo...
2024-09-08 15:40:16.997 | INFO     | generate_benchmark_lean4:configure_leandojo:347 - Current working directory: /data/yingzi_ma/lean_project/ReProver
2024-09-08 15:40:16.997 | INFO     | __main__:main:1150 - LeanDojo configured
2024-09-08 15:40:16.997 | INFO     | __main__:main:1155 - Starting the main process
2024-09-08 15:40:16.997 | INFO     | __main__:main:1163 - Loading database from /data/yingzi_ma/lean_project/dynamic_database_PT_single_repo_no_ewc_pfr.json
2024-09-08 15:40:31.353 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 15:40:31.354 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/teorth/pfr (commit: fa398a5b853c7e94e3294c45e50c6aee013a2687)
2024-09-08 15:40:36.825 | INFO     | dynamic_database:add_repository:600 - Attempting to add repository: https://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-09-08 15:40:36.825 | INFO     | dynamic_database:add_repository:603 - Added new repository: https://github.com/AlexKontorovich/PrimeNumberTheoremAnd (commit: 29baddd685660b5fedd7bd67f9916ae24253d566)
2024-09-08 15:40:37.057 | INFO     | __main__:main:1165 - Loaded database from /data/yingzi_ma/lean_project/dynamic_database_PT_single_repo_no_ewc_pfr.json
2024-09-08 15:40:37.057 | INFO     | __main__:main:1172 - Found 15 repositories
2024-09-08 15:40:37.057 | INFO     | __main__:main:1263 - Starting without curriculum learning
2024-09-08 15:40:37.418 | DEBUG    | lean_dojo.data_extraction.lean:_to_commit_hash:90 - Querying the commit hash for lean4 v4.8.0-rc2
2024-09-08 15:40:52.645 | INFO     | __main__:main:1299 - length of lean_git_repos: 1
2024-09-08 15:40:52.645 | INFO     | __main__:main:1300 - i: 0
2024-09-08 15:40:52.645 | INFO     | __main__:main:1305 - Main process
2024-09-08 15:40:52.645 | INFO     | __main__:main:1306 - Using lambda = 0.0
2024-09-08 15:40:52.645 | INFO     | __main__:main:1307 - Processing https://github.com/AlexKontorovich/PrimeNumberTheoremAnd
2024-09-08 15:40:52.646 | INFO     | __main__:main:1329 - Adding repo to repos_for_merged_dataset
2024-09-08 15:40:52.646 | INFO     | __main__:main:1340 - All GPUs
2024-09-08 15:40:52.646 | INFO     | __main__:main:1569 - Starting the prover
2024-09-08 15:40:52.646 | INFO     | prover.proof_search:__init__:407 - Inside __init__
2024-09-08 15:40:52.646 | INFO     | prover.proof_search:__init__:412 - ckpt_path is not None
2024-09-08 15:40:52.646 | INFO     | prover.proof_search:__init__:427 - Using RAG
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py:57: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly.
It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `
weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.se
rialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../kaiyuy_leandojo-lean4-retriever-tacgen-byt5-small/mo
del_lightning.ckpt`
2024-09-08 15:40:53.321 | INFO     | generator.model:__init__:124 - Retriever checkpoint path: /data/yingzi_ma/lean_project/checkpoints_PT_full_merge_each_time_ewc/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
2024-09-08 15:40:53.321 | INFO     | generator.model:__init__:138 - Loading the retriever from /data/yingzi_ma/lean_project/checkpoints_PT_full_merge_each_time_ewc/mathlib4_29dcec074de168ac2bf835a77ef68bbe069194c5.ckpt
Lightning automatically upgraded your loaded checkpoint from v0.0.0 to v2.2.4. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../checkpoints_PT_full_merge_each_time_ewc/mathlib4_29d
cec074de168ac2bf835a77ef68bbe069194c5.ckpt`
2024-09-08 15:40:56.122 | INFO     | generator.model:__init__:151 - RetrievalAugmentedGenerator initialized
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:184: Found keys that are in the model state dict but not in the checkpoint: ['retriever.encoder.shared.weight', 'retriever.encoder.encoder.em
bed_tokens.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.v.weight', 'retriever.encoder.e
ncoder.block.0.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.0.layer.0.SelfAttention.relative_attention_bias.weight', 'retriever.encoder.encoder.block.0.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.0.layer.1.
DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.0.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.0.layer.1.layer_norm.weight', 'retriever
.encoder.encoder.block.1.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.1.layer.0.SelfAtt
ention.o.weight', 'retriever.encoder.encoder.block.1.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.1.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.
encoder.block.1.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.1.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.k.wei
ght', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.2.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.2.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.2.laye
r.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.2.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.2.layer.1.layer_norm.weight', 'retri
ever.encoder.encoder.block.3.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.3.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.3.layer.0.Sel
fAttention.o.weight', 'retriever.encoder.encoder.block.3.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.3.layer.1.DenseReluDense.wi_1.weight', 'retriever.enco
der.encoder.block.3.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.3.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.k
.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.4.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.4.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.4.
layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.4.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.4.layer.1.layer_norm.weight', 'r
etriever.encoder.encoder.block.5.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.5.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.5.layer.0
.SelfAttention.o.weight', 'retriever.encoder.encoder.block.5.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.5.layer.1.DenseReluDense.wi_1.weight', 'retriever.
encoder.encoder.block.5.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.5.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttenti
on.k.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.6.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.6.layer.0.layer_norm.weight', 'retriever.encoder.encoder.bloc
k.6.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.6.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.6.layer.1.layer_norm.weight'
, 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.7.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.7.lay
er.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.7.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.7.layer.1.DenseReluDense.wi_1.weight', 'retrie
ver.encoder.encoder.block.7.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.7.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAtt
ention.k.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.8.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.8.layer.0.layer_norm.weight', 'retriever.encoder.encoder.
block.8.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.8.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.8.layer.1.layer_norm.wei
ght', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.9.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.9
.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.9.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.9.layer.1.DenseReluDense.wi_1.weight', 're
triever.encoder.encoder.block.9.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.9.layer.1.layer_norm.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.10.layer.0.S
elfAttention.k.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.v.weight', 'retriever.encoder.encoder.block.10.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.10.layer.0.layer_norm.weight', 'retriever.encoder
.encoder.block.10.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wi_1.weight', 'retriever.encoder.encoder.block.10.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.10.layer.1.l
ayer_norm.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.q.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.k.weight', 'retriever.encoder.encoder.block.11.layer.0.SelfAttention.v.weight', 'retriever.encoder
.encoder.block.11.layer.0.SelfAttention.o.weight', 'retriever.encoder.encoder.block.11.layer.0.layer_norm.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wi_0.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDen
se.wi_1.weight', 'retriever.encoder.encoder.block.11.layer.1.DenseReluDense.wo.weight', 'retriever.encoder.encoder.block.11.layer.1.layer_norm.weight', 'retriever.encoder.encoder.final_layer_norm.weight']
/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/pytorch_lightning/core/saving.py:188: Found keys that are not in the model state dict but in the checkpoint: ['pytorch-lightning_version', 'global_step', 'epoch', 'state_dict
', 'callbacks', 'loops', 'legacy_pytorch-lightning_version', 'hyper_parameters']
2024-09-08 15:40:56.659 | INFO     | prover.proof_search:__init__:451 - Loaded model from /data/yingzi_ma/lean_project/kaiyuy_leandojo-lean4-retriever-tacgen-byt5-small/model_lightning.ckpt
2024-09-08 15:40:56.660 | INFO     | prover.proof_search:__init__:452 - Using retriever: PremiseRetriever(
  (encoder): T5EncoderModel(
    (shared): Embedding(384, 1472)
    (encoder): T5Stack(
      (embed_tokens): Embedding(384, 1472)
      (block): ModuleList(
        (0): T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
                (relative_attention_bias): Embedding(32, 6)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1-11): 11 x T5Block(
          (layer): ModuleList(
            (0): T5LayerSelfAttention(
              (SelfAttention): T5Attention(
                (q): Linear(in_features=1472, out_features=384, bias=False)
                (k): Linear(in_features=1472, out_features=384, bias=False)
                (v): Linear(in_features=1472, out_features=384, bias=False)
                (o): Linear(in_features=384, out_features=1472, bias=False)
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (1): T5LayerFF(
              (DenseReluDense): T5DenseGatedActDense(
                (wi_0): Linear(in_features=1472, out_features=3584, bias=False)
                (wi_1): Linear(in_features=1472, out_features=3584, bias=False)
                (wo): Linear(in_features=3584, out_features=1472, bias=False)
                (dropout): Dropout(p=0.1, inplace=False)
                (act): NewGELUActivation()
              )
              (layer_norm): T5LayerNorm()
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (final_layer_norm): T5LayerNorm()
      (dropout): Dropout(p=0.1, inplace=False)
    )
  )
)
2024-09-08 15:40:56.660 | INFO     | prover.proof_search:__init__:455 - Loading indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae2425
3d566/corpus.jsonl
2024-09-08 15:40:56.660 | INFO     | common:__init__:208 - Building the corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253d566/corpus.jso
nl
2024-09-08 15:41:05.551 | INFO     | retrieval.model:load_corpus:159 - Embeddings staled load corpus jsonl: True
2024-09-08 15:41:05.551 | INFO     | prover.proof_search:__init__:457 - Loaded indexed corpus from /data/yingzi_ma/lean_project/datasets_retrieval_single_repo_no_ewc_pfr/merged_with_new_PrimeNumberTheoremAnd_29baddd685660b5fedd7bd67f9916ae24253
d566/corpus.jsonl
2024-09-08 15:41:05.551 | INFO     | prover.proof_search:__init__:471 - Launching 4 workers with 4 GPUs.
2024-09-08 15:41:08,314 INFO worker.py:1774 -- Started a local Ray instance. View the dashboard at 127.0.0.1:8265
(pid=954813) [2024-09-08 15:41:46,735] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=954813) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
 user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experiment
al feature.
(ProverActor pid=954813)   return torch.load(io.BytesIO(b))
(pid=954981) [2024-09-08 15:41:59,176] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=954981) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
 user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experiment
al feature.
(ProverActor pid=954981)   return torch.load(io.BytesIO(b))
(pid=955142) [2024-09-08 15:42:09,024] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=955142) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
 user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experiment
al feature.
(ProverActor pid=955142)   return torch.load(io.BytesIO(b))
2024-09-08 15:42:14.982 | INFO     | __main__:prove_sorry_theorems:781 - Found 27 sorry theorems to prove
Processing theorems from AlexKontorovich/PrimeNumberTheoremAnd:   0%|                                                                                                                                                   | 0/27 [00:00<?, ?theorem/s]
2024-09-08 15:42:14.984 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for integrable_x_mul_Smooth1
2024-09-08 15:42:14.984 | INFO     | __main__:prove_sorry_theorems:805 - Position: (63, 1)
2024-09-08 15:42:14.984 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for lambda_pnt
2024-09-08 15:42:14.985 | INFO     | __main__:prove_sorry_theorems:805 - Position: (326, 1)
2024-09-08 15:42:14.985 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for continuousAt_Smooth1
2024-09-08 15:42:14.985 | INFO     | __main__:prove_sorry_theorems:805 - Position: (76, 1)
2024-09-08 15:42:14.985 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for mu_pnt
2024-09-08 15:42:14.985 | INFO     | __main__:prove_sorry_theorems:805 - Position: (291, 1)
2024-09-08 15:42:14.985 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for crude_upper_bound
2024-09-08 15:42:14.985 | INFO     | __main__:prove_sorry_theorems:805 - Position: (2240, 1)
2024-09-08 15:42:14.985 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for pi_asymp
2024-09-08 15:42:14.986 | INFO     | __main__:prove_sorry_theorems:805 - Position: (95, 1)
2024-09-08 15:42:14.986 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for chebyshev_asymptotic_finsum
2024-09-08 15:42:14.986 | INFO     | __main__:prove_sorry_theorems:805 - Position: (47, 1)
2024-09-08 15:42:14.986 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for mu_pnt_alt
2024-09-08 15:42:14.986 | INFO     | __main__:prove_sorry_theorems:805 - Position: (351, 1)
2024-09-08 15:42:14.986 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for MellinInversion_aux1
2024-09-08 15:42:14.986 | INFO     | __main__:prove_sorry_theorems:805 - Position: (422, 1)
2024-09-08 15:42:14.986 | INFO     | __main__:prove_sorry_theorems:804 - Searching for proof for MellinInversion_aux2
2024-09-08 15:42:14.987 | INFO     | __main__:prove_sorry_theorems:805 - Position: (446, 1)
2024-09-08 15:42:14.987 | INFO     | prover.proof_search:search_unordered:514 - Distributed
(ProverActor pid=954813) 2024-09-08 15:42:15.002 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/AlexKontorovich/PrimeNumberTheoremAnd', commit='29baddd685660b5fedd7bd67f9916ae24253d566'), f
ile_path=PosixPath('PrimeNumberTheoremAnd/Consequences.lean'), full_name='mu_pnt')
(ProverActor pid=954981) 2024-09-08 15:42:15.001 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/AlexKontorovich/PrimeNumberTheoremAnd', commit='29baddd685660b5fedd7bd67f9916ae24253d566'), f
ile_path=PosixPath('PrimeNumberTheoremAnd/MediumPNT.lean'), full_name='continuousAt_Smooth1')
(ProverActor pid=955142) 2024-09-08 15:42:21.962 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/AlexKontorovich/PrimeNumberTheoremAnd', commit='29baddd685660b5fedd7bd67f9916ae24253d566'), f
ile_path=PosixPath('PrimeNumberTheoremAnd/Consequences.lean'), full_name='lambda_pnt')
(pid=955320) [2024-09-08 15:42:22,142] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
(ProverActor pid=955320) /data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle
module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the
default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the
 user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experiment
al feature.
(ProverActor pid=955320)   return torch.load(io.BytesIO(b))
(ProverActor pid=955320) 2024-09-08 15:42:34.422 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/AlexKontorovich/PrimeNumberTheoremAnd', commit='29baddd685660b5fedd7bd67f9916ae24253d566'), f
ile_path=PosixPath('PrimeNumberTheoremAnd/MediumPNT.lean'), full_name='integrable_x_mul_Smooth1')
(ProverActor pid=954981) 2024-09-08 15:43:06.469 | INFO     | lean_dojo.utils:execute:88 -
(ProverActor pid=954813) 2024-09-08 15:43:06.558 | ERROR    | lean_dojo.utils:execute:89 - info: downloading component 'lean'
(ProverActor pid=954813) info: installing component 'lean'
(ProverActor pid=954813) error: could not remove 'temp toolchain directory' directory: '/data/yingzi_ma/.elan/toolchains/leanprover--lean4---v4.8.tmp'
(ProverActor pid=954813) info: caused by: Directory not empty (os error 39)
(ProverActor pid=954813)
(ProverActor pid=954981) info: caused by: No such file or directory (os error 2)
(ProverActor pid=954981)
Processing theorems from AlexKontorovich/PrimeNumberTheoremAnd:  33%|                                                                                            | 9/27 [00:54<01:49,  6.06s/theorem]
2024-09-08 15:43:09.500 | INFO     | __main__:main:1631 - An error occurred: ray::ProverActor.search() (pid=954813, ip=10.0.4.105, actor_id=975d90db15c7128ac695ac7601000000, repr=<prover.proof_search.ProverActor object at 0x73691ad53400>)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 332, in search
    return self.prover.search(repo, thm, pos)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 96, in search
    with Dojo(thm, self.timeout, additional_imports=imps) as (
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 255, in __enter__
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 197, in __enter__
    self.container.run(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/container.py", line 194, in run
    execute(cmd, capture_output=capture_output)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 90, in execute
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 85, in execute
    res = subprocess.run(cmd, shell=True, capture_output=capture_output, check=True)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'lake build Lean4Repl' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 1600, in main
    prove_sorry_theorems(db, prover, dynamic_database_json_path, repos_for_merged_dataset)
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 818, in prove_sorry_theorems
    process_theorem_batch(theorem_batch, positions_batch, repo, db, prover, dynamic_database_json_path)
  File "/data/yingzi_ma/lean_project/ReProver/main.py", line 710, in process_theorem_batch
    results = prover.search_unordered(LeanGitRepo(repo.url, repo.commit), lean_dojo_theorems, positions_batch)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 515, in search_unordered
    results = list(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/util/actor_pool.py", line 170, in get_generator
    yield self.get_next_unordered()
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/util/actor_pool.py", line 370, in get_next_unordered
    return ray.get(future)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
(ProverActor pid=954813) 2024-09-08 15:43:09.501 | INFO     | prover.proof_search:search:81 - Proving Theorem(repo=LeanGitRepo(url='https://github.com/AlexKontorovich/PrimeNumberTheoremAnd', commit='29baddd685660b5fedd7bd67f9916ae24253d566'), f
ile_path=PosixPath('PrimeNumberTheoremAnd/Wiener.lean'), full_name='crude_upper_bound')
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/_private/worker.py", line 2661, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/ray/_private/worker.py", line 871, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(CalledProcessError): ray::ProverActor.search() (pid=954813, ip=10.0.4.105, actor_id=975d90db15c7128ac695ac7601000000, repr=<prover.proof_search.ProverActor object at 0x73691ad53400>)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 332, in search
    return self.prover.search(repo, thm, pos)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 96, in search
    with Dojo(thm, self.timeout, additional_imports=imps) as (
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 255, in __enter__
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 197, in __enter__
    self.container.run(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/container.py", line 194, in run
    execute(cmd, capture_output=capture_output)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 90, in execute
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 85, in execute
    res = subprocess.run(cmd, shell=True, capture_output=capture_output, check=True)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'lake build Lean4Repl' returned non-zero exit status 1.
2024-09-08 15:43:10,223 ERROR worker.py:409 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): ray::ProverActor.search() (pid=954981, ip=10.0.4.105, actor_id=15ff1172ca596abeb702457d01000000, repr=<prover.proof_search.ProverAct
or object at 0x76851210f460>)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 332, in search
    return self.prover.search(repo, thm, pos)
  File "/data/yingzi_ma/lean_project/ReProver/prover/proof_search.py", line 96, in search
    with Dojo(thm, self.timeout, additional_imports=imps) as (
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 255, in __enter__
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 197, in __enter__
    self.container.run(
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/container.py", line 194, in run
    execute(cmd, capture_output=capture_output)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 90, in execute
    raise ex
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/site-packages/lean_dojo/utils.py", line 85, in execute
    res = subprocess.run(cmd, shell=True, capture_output=capture_output, check=True)
  File "/data/yingzi_ma/miniconda3/envs/ReProver/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'lake build Lean4Repl' returned non-zero exit status 1.
(ProverActor pid=954813) 2024-09-08 15:43:06.470 | INFO     | lean_dojo.utils:execute:88 -
(ProverActor pid=954981) 2024-09-08 15:43:06.558 | ERROR    | lean_dojo.utils:execute:89 - info: downloading component 'lean'
(ProverActor pid=954981) info: installing component 'lean'
(ProverActor pid=954981) error: could not remove 'temp toolchain directory' directory: '/data/yingzi_ma/.elan/toolchains/leanprover--lean4---v4.8.tmp'
(ReProver) yingzi_ma@compute-permanent-node-106:~/lean_project/ReProver$
